<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Accessing and reformatting output &mdash; CatMAP 0.2.79 documentation</title>
    
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.2.79',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="CatMAP 0.2.79 documentation" href="../index.html" />
    <link rel="up" title="Topics" href="index.html" />
    <link rel="next" title="&lt;no title&gt;" href="thermodynamic_descriptors.html" />
    <link rel="prev" title="Code Overview" href="code_overview.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="thermodynamic_descriptors.html" title="&lt;no title&gt;"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="code_overview.html" title="Code Overview"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">CatMAP 0.2.79 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Topics</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="accessing-and-reformatting-output">
<h1>Accessing and reformatting output<a class="headerlink" href="#accessing-and-reformatting-output" title="Permalink to this headline">Â¶</a></h1>
<p>The purpose of this tutorial is to provide an explanation of how to
access the raw output of CatMAP. The plotting functions included in
CatMAP are not meant to provide publication-quality figures by default,
but rather to provide a quick way of analyzing the output and
determining whether or not the solution is correct. If you want to
create more complex plots, or more beautiful plots, then you will likely
want to reformat the raw data and plot it with software of your choice
(MATLAB, etc.) or at least know how to access the matplotlib figure
object if you are brave enough to directly edit the figure in python.</p>
<p>The simplest approach to post-processing is to convert the CatMAP output
into a data table and use methods you are familiar with. We will use the
CO oxidation example from tutorial 3 to provide some concrete context.
If you have run Tutorial 3 you should have the file &#8220;CO_oxidation.log&#8221;
in the tutorial 3 directory. Assuming you finished the tutorial, this
file should have outputs for the coverage, rate, production_rate, and
rate_control. We will look at how to read in each of these and convert
them to more conventional tables.</p>
<p>First, lets take a look at how output is stored natively by CatMAP.
Create a script with the following commands in the tutorial 3 directory:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">catmap.model</span> <span class="kn">import</span> <span class="n">ReactionModel</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">ReactionModel</span><span class="p">(</span><span class="n">setup_file</span><span class="o">=</span><span class="s">&#39;CO_oxidation.log&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>which reads the model (along with outputs) into the script. The model,
after its run, will have &#8220;map&#8221; attributes for each output variable. The
map is a python list structured like:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="p">[</span>
<span class="p">[[</span><span class="n">x_0</span><span class="p">,</span><span class="n">y_0</span><span class="p">],[</span><span class="n">out_0_0</span><span class="p">,</span> <span class="n">out_0_1</span><span class="p">,</span> <span class="o">...</span> <span class="p">,</span> <span class="n">out_0_n</span><span class="p">]],</span>
<span class="p">[[</span><span class="n">x_1</span><span class="p">,</span><span class="n">y_1</span><span class="p">],[</span><span class="n">out_1_0</span><span class="p">,</span> <span class="n">out_1_1</span><span class="p">,</span> <span class="o">...</span> <span class="p">,</span> <span class="n">out_1_n</span><span class="p">]],</span>
<span class="o">...</span><span class="p">,</span>
<span class="p">[[</span><span class="n">x_m</span><span class="p">,</span><span class="n">y_m</span><span class="p">],[</span><span class="n">out_m_0</span><span class="p">,</span> <span class="n">out_m_1</span><span class="p">,</span> <span class="o">...</span> <span class="p">,</span> <span class="n">out_m_n</span><span class="p">]]</span>
<span class="p">]</span>
</pre></div>
</div>
<p>where x and y represent descriptor values, and out_i_j represents the
output vector at each point. For example, the coverage map on the CO
oxidation model. Add the following to the script:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">for</span> <span class="n">pt</span><span class="p">,</span> <span class="n">cvgs</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">coverage_map</span><span class="p">:</span>
    <span class="k">print</span> <span class="s">&#39;descriptors:&#39;</span><span class="p">,</span> <span class="n">pt</span>
    <span class="k">print</span> <span class="s">&#39;coverages&#39;</span><span class="p">,</span> <span class="n">cvgs</span>
</pre></div>
</div>
<p>If you run this you will get a bunch of numbers like:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">descriptors</span> <span class="p">[</span><span class="mf">1.9289202008928572</span><span class="p">,</span> <span class="mf">2.232142857142857</span><span class="p">]</span>
<span class="n">coverages</span> <span class="p">[</span><span class="n">mpf</span><span class="p">(</span><span class="s">&#39;2.2800190488939763e-5&#39;</span><span class="p">),</span> <span class="n">mpf</span><span class="p">(</span><span class="s">&#39;0.020278026143493406&#39;</span><span class="p">),</span> <span class="n">mpf</span><span class="p">(</span><span class="s">&#39;2.2031908471388691e-7&#39;</span><span class="p">),</span> <span class="n">mpf</span><span class="p">(</span><span class="s">&#39;1.4713059814195941e-5&#39;</span><span class="p">),</span> <span class="n">mpf</span><span class="p">(</span><span class="s">&#39;0.18181715627634512&#39;</span><span class="p">)]</span>
<span class="n">descriptors</span> <span class="p">[</span><span class="mf">0.1428571428571428</span><span class="p">,</span> <span class="mf">2.553571428571429</span><span class="p">]</span>
<span class="n">coverages</span> <span class="p">[</span><span class="n">mpf</span><span class="p">(</span><span class="s">&#39;2.7893704760253176e-27&#39;</span><span class="p">),</span> <span class="n">mpf</span><span class="p">(</span><span class="s">&#39;0.050000000000000003&#39;</span><span class="p">),</span> <span class="n">mpf</span><span class="p">(</span><span class="s">&#39;2.8850535476689032e-25&#39;</span><span class="p">),</span> <span class="n">mpf</span><span class="p">(</span><span class="s">&#39;1.4466885932549904e-12&#39;</span><span class="p">),</span> <span class="n">mpf</span><span class="p">(</span><span class="s">&#39;0.94999999999855326&#39;</span><span class="p">)]</span>
<span class="n">descriptors</span> <span class="p">[</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">1.267857142857143</span><span class="p">]</span>
<span class="n">coverages</span> <span class="p">[</span><span class="n">mpf</span><span class="p">(</span><span class="s">&#39;0.049999987577682677&#39;</span><span class="p">),</span> <span class="n">mpf</span><span class="p">(</span><span class="s">&#39;4.4864510401468476e-25&#39;</span><span class="p">),</span> <span class="n">mpf</span><span class="p">(</span><span class="s">&#39;0.69752183650972651&#39;</span><span class="p">),</span> <span class="n">mpf</span><span class="p">(</span><span class="s">&#39;4.653706806446857e-10&#39;</span><span class="p">),</span> <span class="n">mpf</span><span class="p">(</span><span class="s">&#39;1.789519988373698e-17&#39;</span><span class="p">)]</span>
<span class="n">descriptors</span> <span class="p">[</span><span class="mf">2.1830357142857144</span><span class="p">,</span> <span class="mf">2.8750000000000004</span><span class="p">]</span>
<span class="n">coverages</span> <span class="p">[</span><span class="n">mpf</span><span class="p">(</span><span class="s">&#39;6.4052886383458481e-12&#39;</span><span class="p">),</span> <span class="n">mpf</span><span class="p">(</span><span class="s">&#39;0.024816133631270126&#39;</span><span class="p">),</span> <span class="n">mpf</span><span class="p">(</span><span class="s">&#39;3.4777261296001614e-13&#39;</span><span class="p">),</span> <span class="n">mpf</span><span class="p">(</span><span class="s">&#39;6.8031802914834851e-9&#39;</span><span class="p">),</span> <span class="n">mpf</span><span class="p">(</span><span class="s">&#39;0.32310023705530582&#39;</span><span class="p">)]</span>
<span class="o">...</span>
</pre></div>
</div>
<p>You should note that the coverages are &#8220;mpf&#8221; objects, which indicates
that they are multiple precision. You probably also don&#8217;t know which
intermediate each coverage corresponds to. Try the following:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">labels</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">output_labels</span><span class="p">[</span><span class="s">&#39;coverage&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">pt</span><span class="p">,</span><span class="n">cvg</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">coverage_map</span><span class="p">:</span>
    <span class="k">print</span> <span class="s">&#39;descriptors&#39;</span><span class="p">,</span><span class="n">pt</span>
    <span class="k">print</span> <span class="s">&#39;intermediates&#39;</span><span class="p">,</span><span class="n">labels</span>
    <span class="k">print</span> <span class="s">&#39;coverages&#39;</span><span class="p">,</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cvg</span><span class="p">]</span>
</pre></div>
</div>
<p>which gives the slightly more readable output:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">descriptors</span> <span class="p">[</span><span class="mf">1.9289202008928572</span><span class="p">,</span> <span class="mf">2.232142857142857</span><span class="p">]</span>
<span class="n">intermediates</span> <span class="p">(</span><span class="s">&#39;CO_s&#39;</span><span class="p">,</span> <span class="s">&#39;O_s&#39;</span><span class="p">,</span> <span class="s">&#39;CO_t&#39;</span><span class="p">,</span> <span class="s">&#39;O2_t&#39;</span><span class="p">,</span> <span class="s">&#39;O_t&#39;</span><span class="p">)</span>
<span class="n">coverages</span> <span class="p">[</span><span class="mf">2.2800190488939762e-05</span><span class="p">,</span> <span class="mf">0.020278026143493406</span><span class="p">,</span> <span class="mf">2.203190847138869e-07</span><span class="p">,</span> <span class="mf">1.471305981419594e-05</span><span class="p">,</span> <span class="mf">0.1818171562763451</span><span class="p">]</span>
<span class="n">descriptors</span> <span class="p">[</span><span class="mf">0.1428571428571428</span><span class="p">,</span> <span class="mf">2.553571428571429</span><span class="p">]</span>
<span class="n">intermediates</span> <span class="p">(</span><span class="s">&#39;CO_s&#39;</span><span class="p">,</span> <span class="s">&#39;O_s&#39;</span><span class="p">,</span> <span class="s">&#39;CO_t&#39;</span><span class="p">,</span> <span class="s">&#39;O2_t&#39;</span><span class="p">,</span> <span class="s">&#39;O_t&#39;</span><span class="p">)</span>
<span class="n">coverages</span> <span class="p">[</span><span class="mf">2.7893704760253176e-27</span><span class="p">,</span> <span class="mf">0.049999999999999996</span><span class="p">,</span> <span class="mf">2.885053547668903e-25</span><span class="p">,</span> <span class="mf">1.4466885932549903e-12</span><span class="p">,</span> <span class="mf">0.9499999999985532</span><span class="p">]</span>
<span class="n">descriptors</span> <span class="p">[</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">1.267857142857143</span><span class="p">]</span>
<span class="n">intermediates</span> <span class="p">(</span><span class="s">&#39;CO_s&#39;</span><span class="p">,</span> <span class="s">&#39;O_s&#39;</span><span class="p">,</span> <span class="s">&#39;CO_t&#39;</span><span class="p">,</span> <span class="s">&#39;O2_t&#39;</span><span class="p">,</span> <span class="s">&#39;O_t&#39;</span><span class="p">)</span>
<span class="n">coverages</span> <span class="p">[</span><span class="mf">0.049999987577682675</span><span class="p">,</span> <span class="mf">4.486451040146847e-25</span><span class="p">,</span> <span class="mf">0.6975218365097264</span><span class="p">,</span> <span class="mf">4.653706806446857e-10</span><span class="p">,</span> <span class="mf">1.7895199883736977e-17</span><span class="p">]</span>
<span class="n">descriptors</span> <span class="p">[</span><span class="mf">2.1830357142857144</span><span class="p">,</span> <span class="mf">2.8750000000000004</span><span class="p">]</span>
<span class="n">intermediates</span> <span class="p">(</span><span class="s">&#39;CO_s&#39;</span><span class="p">,</span> <span class="s">&#39;O_s&#39;</span><span class="p">,</span> <span class="s">&#39;CO_t&#39;</span><span class="p">,</span> <span class="s">&#39;O2_t&#39;</span><span class="p">,</span> <span class="s">&#39;O_t&#39;</span><span class="p">)</span>
<span class="n">coverages</span> <span class="p">[</span><span class="mf">6.405288638345848e-12</span><span class="p">,</span> <span class="mf">0.024816133631270124</span><span class="p">,</span> <span class="mf">3.477726129600161e-13</span><span class="p">,</span> <span class="mf">6.803180291483484e-09</span><span class="p">,</span> <span class="mf">0.3231002370553058</span><span class="p">]</span>
<span class="o">...</span>
</pre></div>
</div>
<p>Based on this, you can probably see how to create a text table
containing coverage outputs. All the other outputs follow the same basic
format; however, there are a few tricky situations when looking at other
outputs. For example, the &#8220;labels&#8221; for reaction-specific quantities
(rates, rate constants, etc.) are actually lists which need to be
flattened into strings. Even more difficult are &#8220;matrix&#8221; outputs like
rate control, where the output is a list of lists rather than a single
list. To make life easier I have created the following script which
should create a tab-separated text table from any output (.log) file
created by CatMAP. Just place this script into the output directory, and
run it with the name of the output of interest as its first argument.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">glob</span> <span class="kn">import</span> <span class="n">glob</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">catmap.model</span> <span class="kn">import</span> <span class="n">ReactionModel</span>

<span class="n">output_variable</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">logfile</span> <span class="o">=</span> <span class="n">glob</span><span class="p">(</span><span class="s">&#39;*.log&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">logfile</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
    <span class="k">raise</span> <span class="n">InputError</span><span class="p">(</span><span class="s">&#39;Ambiguous logfile. Ensure that only one file ends with .log&#39;</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">ReactionModel</span><span class="p">(</span><span class="n">setup_file</span><span class="o">=</span><span class="n">logfile</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="k">if</span> <span class="n">output_variable</span> <span class="o">==</span> <span class="s">&#39;rate_control&#39;</span><span class="p">:</span>
    <span class="n">dim</span> <span class="o">=</span> <span class="mi">2</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">dim</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">labels</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">output_labels</span><span class="p">[</span><span class="n">output_variable</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">flatten_2d</span><span class="p">(</span><span class="n">output</span><span class="p">):</span>
    <span class="s">&quot;Helper function for flattening rate_control output&quot;</span>
    <span class="n">flat</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">output</span><span class="p">:</span>
        <span class="n">flat</span><span class="o">+=</span> <span class="n">x</span>
    <span class="k">return</span> <span class="n">flat</span>

<span class="c">#flatten rate_control labels</span>
<span class="k">if</span> <span class="n">output_variable</span> <span class="o">==</span> <span class="s">&#39;rate_control&#39;</span><span class="p">:</span>
    <span class="n">flat_labels</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">flat_labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;d&#39;</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="s">&#39;/d&#39;</span><span class="o">+</span><span class="n">j</span><span class="p">)</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">flat_labels</span>

<span class="c">#flatten elementary-step specific labels</span>
<span class="k">if</span> <span class="n">output_variable</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;rate&#39;</span><span class="p">,</span><span class="s">&#39;rate_constant&#39;</span><span class="p">,</span><span class="s">&#39;forward_rate_constant&#39;</span><span class="p">,</span><span class="s">&#39;reverse_rate_constant&#39;</span><span class="p">]:</span>
    <span class="n">str_labels</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">:</span>
        <span class="n">states</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;+&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">label</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">states</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">new_label</span> <span class="o">=</span> <span class="s">&#39;&lt;-&gt;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">states</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_label</span> <span class="o">=</span> <span class="n">states</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s">&#39;&lt;-&gt;&#39;</span><span class="o">+</span><span class="n">states</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s">&#39;-&gt;&#39;</span><span class="o">+</span><span class="n">states</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">str_labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_label</span><span class="p">)</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">str_labels</span>

<span class="n">table</span> <span class="o">=</span> <span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">list</span><span class="p">([</span><span class="s">&#39;descriptor-&#39;</span><span class="o">+</span><span class="n">d</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">descriptor_names</span><span class="p">])</span><span class="o">+</span><span class="nb">list</span><span class="p">(</span><span class="n">labels</span><span class="p">))</span><span class="o">+</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>

<span class="k">for</span> <span class="n">pt</span><span class="p">,</span> <span class="n">output</span> <span class="ow">in</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">output_variable</span><span class="o">+</span><span class="s">&#39;_map&#39;</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">flatten_2d</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
    <span class="n">table</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">pt</span><span class="o">+</span><span class="n">output</span><span class="p">])</span><span class="o">+</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>

<span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_variable</span><span class="o">+</span><span class="s">&#39;_table.txt&#39;</span><span class="p">,</span><span class="s">&#39;w&#39;</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>This should give you the ability to import CatMAP output into pretty
much any other analysis or plotting program. However, if you are a
matplotlib loyalist you may want to try to edit the figure objects
directly, or perhaps even exploit the plotting capabilities of CatMAP to
plot some &#8220;map&#8221; other than those created by CatMAP. For example, lets
say that for whatever reason we wanted to plot the coverage of CO*
times the rate of CO2 formation. We can do this by creating a python
script:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">catmap.model</span> <span class="kn">import</span> <span class="n">ReactionModel</span>
<span class="kn">from</span> <span class="nn">catmap.analyze</span> <span class="kn">import</span> <span class="n">VectorMap</span>

<span class="n">log_file</span> <span class="o">=</span> <span class="s">&#39;CO_oxidation.log&#39;</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">ReactionModel</span><span class="p">(</span><span class="n">setup_file</span><span class="o">=</span><span class="n">log_file</span><span class="p">)</span>

<span class="n">CO_cvg_CO2_rate_map</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">CO_idx</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">output_labels</span><span class="p">[</span><span class="s">&#39;coverage&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s">&#39;CO_s&#39;</span><span class="p">)</span>
<span class="n">CO2_idx</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">output_labels</span><span class="p">[</span><span class="s">&#39;production_rate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s">&#39;CO2_g&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">pt_cvg</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">coverage_map</span><span class="p">):</span>
    <span class="n">pt_rate</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">production_rate_map</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">pt</span><span class="p">,</span><span class="n">cvg</span> <span class="o">=</span> <span class="n">pt_cvg</span>
    <span class="n">pt_i</span><span class="p">,</span><span class="n">rate</span> <span class="o">=</span> <span class="n">pt_rate</span>
    <span class="k">assert</span> <span class="n">pt</span> <span class="o">==</span> <span class="n">pt_i</span> <span class="c">#ensure that points are the same</span>

    <span class="n">CO_cvg</span> <span class="o">=</span> <span class="n">cvg</span><span class="p">[</span><span class="n">CO_idx</span><span class="p">]</span>
    <span class="n">CO2_rate</span> <span class="o">=</span> <span class="n">rate</span><span class="p">[</span><span class="n">CO2_idx</span><span class="p">]</span>
    <span class="n">CO_cvg_CO2_rate_map</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">pt</span><span class="p">,[</span><span class="n">CO_cvg</span><span class="o">*</span><span class="n">CO2_rate</span><span class="p">]])</span> <span class="c">#multiply the two and store in new map</span>

<span class="n">model</span><span class="o">.</span><span class="n">CO_cvg_CO2_rate_map</span> <span class="o">=</span> <span class="n">CO_cvg_CO2_rate_map</span> <span class="c">#trick the model into thinking it has this output</span>
<span class="n">model</span><span class="o">.</span><span class="n">output_labels</span><span class="p">[</span><span class="s">&#39;CO_cvg_CO2_rate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;theta_CO*r_CO2&#39;</span><span class="p">]</span>

<span class="n">vm</span> <span class="o">=</span> <span class="n">VectorMap</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">vm</span><span class="o">.</span><span class="n">plot_variable</span> <span class="o">=</span> <span class="s">&#39;CO_cvg_CO2_rate&#39;</span> <span class="c">#tell the model to plot the output you just created</span>
<span class="n">vm</span><span class="o">.</span><span class="n">log_scale</span> <span class="o">=</span> <span class="bp">True</span> <span class="c">#rates should be plotted on a log-scale</span>
<span class="n">vm</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span> <span class="mf">1e-25</span> <span class="c">#minimum rate to plot</span>
<span class="n">vm</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="mf">1e3</span> <span class="c">#maximum rate to plot</span>
<span class="n">vm</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="mf">1e-25</span> <span class="c">#anything below this is considered to be 0</span>
<span class="n">vm</span><span class="o">.</span><span class="n">subplots_adjust_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;left&#39;</span><span class="p">:</span><span class="mf">0.2</span><span class="p">,</span><span class="s">&#39;right&#39;</span><span class="p">:</span><span class="mf">0.8</span><span class="p">,</span><span class="s">&#39;bottom&#39;</span><span class="p">:</span><span class="mf">0.15</span><span class="p">}</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">vm</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">save</span><span class="o">=</span><span class="s">&#39;CO_cvg_CO2_rate.pdf&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>If you run this script you will have a CatMAP-style plot of the CO*
coverage multiplied by the CO2 formation rate. If you want to make
post-processing modifications to the plot, then you should note that the
output of the <code class="docutils literal"><span class="pre">VectorMap.plot</span></code> function is actually a
<code class="docutils literal"><span class="pre">matplotlib.figure</span></code> object. You can get the handles for each axis by
iterating through the <code class="docutils literal"><span class="pre">figure.axes</span></code> attribute. Sometimes it is
convenient to label each axis the first time through to know which one
you are editing. For example, add the following lines to the script:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">for</span> <span class="n">j</span><span class="p">,</span><span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">axes</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">),</span> <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.9</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;w&#39;</span><span class="p">,</span> <span class="n">xycoords</span><span class="o">=</span><span class="s">&#39;axes fraction&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;figure_with_axes_labels.pdf&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Now if you look at the plot you will see the main axis is labeled 0,
while the colorbar is 1. You can then edit the axes properties using
matplotlib. Manipulating matplotlib figures is beyond the scope of this
tutorial, but there is plenty of good documentation at
<a class="reference external" href="http://matplotlib.org/">http://matplotlib.org/</a>.</p>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="code_overview.html"
                        title="previous chapter">Code Overview</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="thermodynamic_descriptors.html"
                        title="next chapter">&lt;no title&gt;</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/topics/accessing_reformatting_output.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="thermodynamic_descriptors.html" title="&lt;no title&gt;"
             >next</a> |</li>
        <li class="right" >
          <a href="code_overview.html" title="Code Overview"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">CatMAP 0.2.79 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Topics</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2014, Andrew J. Medford.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>