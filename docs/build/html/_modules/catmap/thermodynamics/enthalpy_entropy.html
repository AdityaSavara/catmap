<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>catmap.thermodynamics.enthalpy_entropy &mdash; CatMAP 0.2.79 documentation</title>
    
    <link rel="stylesheet" href="../../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '0.2.79',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="CatMAP 0.2.79 documentation" href="../../../index.html" />
    <link rel="up" title="catmap" href="../../catmap.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">CatMAP 0.2.79 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="../../catmap.html" accesskey="U">catmap</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for catmap.thermodynamics.enthalpy_entropy</h1><div class="highlight"><pre>
<span class="kn">import</span> <span class="nn">catmap</span>
<span class="kn">from</span> <span class="nn">catmap</span> <span class="kn">import</span> <span class="n">ReactionModelWrapper</span>
<span class="kn">from</span> <span class="nn">catmap.model</span> <span class="kn">import</span> <span class="n">ReactionModel</span>
<span class="kn">from</span> <span class="nn">catmap.functions</span> <span class="kn">import</span> <span class="n">get_composition</span><span class="p">,</span> <span class="n">add_dict_in_place</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">fmin_powell</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">mpmath</span> <span class="kn">import</span> <span class="n">mpf</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">exp</span><span class="p">,</span> <span class="n">log</span>
<span class="n">IdealGasThermo</span> <span class="o">=</span> <span class="n">catmap</span><span class="o">.</span><span class="n">IdealGasThermo</span>
<span class="n">HarmonicThermo</span> <span class="o">=</span> <span class="n">catmap</span><span class="o">.</span><span class="n">HarmonicThermo</span>
<span class="n">molecule</span> <span class="o">=</span> <span class="n">catmap</span><span class="o">.</span><span class="n">molecule</span>
<span class="n">np</span> <span class="o">=</span> <span class="n">catmap</span><span class="o">.</span><span class="n">np</span>
<span class="n">copy</span> <span class="o">=</span> <span class="n">catmap</span><span class="o">.</span><span class="n">copy</span>

<div class="viewcode-block" id="ThermoCorrections"><a class="viewcode-back" href="../../../reference/catmap.thermodynamics.html#catmap.thermodynamics.enthalpy_entropy.ThermoCorrections">[docs]</a><span class="k">class</span> <span class="nc">ThermoCorrections</span><span class="p">(</span><span class="n">ReactionModelWrapper</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class for including thermodynamic corrections.</span>

<span class="sd">    The function &quot;get_thermodynamic_corrections&quot; automatically does all the work</span>
<span class="sd">    assuming the correct functions are in place.</span>

<span class="sd">    thermodynamic_corrections: List of fundamentally different types of </span>
<span class="sd">        corrections which could be included. Defaults are gas and adsorbate</span>
<span class="sd">        but other possibilities might be interface, electrochemical, etc.</span>

<span class="sd">    thermodynamic_variables: List of variables which define a thermodynamic</span>
<span class="sd">        state. If these attributes of the underlying reaction model do not</span>
<span class="sd">        change then the thermodynamic corrections will not be recalculated</span>
<span class="sd">        in order to save time.</span>

<span class="sd">    To add a new correction type (called custom_correction):</span>
<span class="sd">        1) Define the function which performs the correction as an attribute.</span>
<span class="sd">            Assume the function is called &quot;simple_custom_correction&quot;.</span>
<span class="sd">        2) Place the &quot;custom_correction&quot; in the &quot;thermodynamic_corrections&quot; list</span>
<span class="sd">        3) Place any variables which the custom correction depends on in</span>
<span class="sd">            the thermodynamic_variables list</span>
<span class="sd">        4) Set the &quot;custom_correction_thermo_mode&quot; attribute of the </span>
<span class="sd">            underlying reaction model to &quot;simple_custom_correction&quot;</span>

<span class="sd">    If these steps are followed then the correction should automatically be</span>
<span class="sd">    included in all calculations.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_kJmol2eV</span> <span class="o">=</span> <span class="mf">0.01036427</span>
    <span class="n">_bar2Pa</span> <span class="o">=</span> <span class="mf">1e5</span>

<div class="viewcode-block" id="ThermoCorrections.__init__"><a class="viewcode-back" href="../../../reference/catmap.thermodynamics.html#catmap.thermodynamics.enthalpy_entropy.ThermoCorrections.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">reaction_model</span><span class="o">=</span><span class="n">ReactionModel</span><span class="p">()):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rxm</span> <span class="o">=</span> <span class="n">reaction_model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_log_strings</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">&#39;harmonic_transition_state_warning&#39;</span><span class="p">:</span>
        <span class="s">&#39;averaging initial/final state thermal contributions for ${TS}&#39;</span><span class="p">,</span>
        <span class="s">&#39;shomate_warning&#39;</span><span class="p">:</span>
        <span class="s">&#39;temperature below shomate minumum for ${gas};&#39;</span><span class="o">+</span>
        <span class="s">&#39; Cp(${T}) and S(${T}) are used below ${T}.&#39;</span>
        <span class="p">}</span>

        <span class="c">#set defaults</span>
        <span class="n">defaults</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                <span class="n">gas_thermo_mode</span> <span class="o">=</span> <span class="s">&#39;ideal_gas&#39;</span><span class="p">,</span>
                <span class="n">adsorbate_thermo_mode</span> <span class="o">=</span> <span class="s">&#39;harmonic_adsorbate&#39;</span><span class="p">,</span>
                <span class="n">electrochemical_thermo_mode</span> <span class="o">=</span> <span class="s">&#39;simple_electrochemical&#39;</span><span class="p">,</span>
                <span class="n">pressure_mode</span> <span class="o">=</span> <span class="s">&#39;static&#39;</span><span class="p">,</span>
                <span class="n">thermodynamic_corrections</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;gas&#39;</span><span class="p">,</span><span class="s">&#39;adsorbate&#39;</span><span class="p">,</span><span class="s">&#39;electrochemical&#39;</span><span class="p">],</span>
                <span class="n">thermodynamic_variables</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;temperature&#39;</span><span class="p">,</span><span class="s">&#39;gas_pressures&#39;</span><span class="p">,</span><span class="s">&#39;voltage&#39;</span><span class="p">,</span><span class="s">&#39;beta&#39;</span><span class="p">,</span><span class="s">&#39;pH&#39;</span><span class="p">],</span>
                <span class="n">ideal_gas_params</span> <span class="o">=</span> <span class="n">catmap</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">ideal_gas_params</span><span class="p">,</span>
                <span class="n">fixed_entropy_dict</span> <span class="o">=</span> <span class="n">catmap</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">fixed_entropy_dict</span><span class="p">,</span>
                <span class="n">shomate_params</span> <span class="o">=</span> <span class="n">catmap</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shomate_params</span><span class="p">,</span>
                <span class="n">hbond_dict</span> <span class="o">=</span> <span class="n">catmap</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">hbond_dict</span><span class="p">,</span>
                <span class="n">atoms_dict</span> <span class="o">=</span> <span class="p">{},</span>
                <span class="n">frequency_dict</span> <span class="o">=</span> <span class="p">{},</span>
                <span class="n">force_recalculation</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_required</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;thermodynamic_corrections&#39;</span><span class="p">:</span><span class="nb">list</span><span class="p">,</span>
                <span class="s">&#39;thermodynamic_variables&#39;</span><span class="p">:</span><span class="nb">list</span><span class="p">,</span>
                <span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_zpe_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_enthalpy_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_entropy_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rxm</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">defaults</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">corr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">thermodynamic_corrections</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_required</span><span class="p">[</span><span class="n">corr</span><span class="o">+</span><span class="s">&#39;_thermo_mode&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">thermodynamic_variables</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">corr</span><span class="o">+</span><span class="s">&#39;_thermo_mode&#39;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ThermoCorrections.get_thermodynamic_corrections"><a class="viewcode-back" href="../../../reference/catmap.thermodynamics.html#catmap.thermodynamics.enthalpy_entropy.ThermoCorrections.get_thermodynamic_corrections">[docs]</a>    <span class="k">def</span> <span class="nf">get_thermodynamic_corrections</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate all ``thermodynamic&#39;&#39; corrections beyond the energies</span>
<span class="sd">        in the input file. This master function will call sub-functions</span>
<span class="sd">        depending on the ``thermo mode&#39;&#39; of each class of species</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">l</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thermodynamic_corrections</span>
        <span class="k">if</span> <span class="s">&#39;electrochemical&#39;</span> <span class="ow">in</span> <span class="n">l</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">echem_transition_state_names</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">force_recalculation</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">state_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">thermodynamic_variables</span><span class="p">:</span>
            <span class="n">state_dict</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">state_dict</span><span class="p">:</span>
                <span class="n">state_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="n">current_state</span> <span class="o">=</span> <span class="p">[</span><span class="nb">repr</span><span class="p">(</span><span class="n">state_dict</span><span class="p">[</span><span class="n">v</span><span class="p">])</span> 
                <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">thermodynamic_variables</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">sp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species_definitions</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">frequency_dict</span><span class="p">[</span><span class="n">sp</span><span class="p">]</span> <span class="o">=</span> \
                    <span class="bp">self</span><span class="o">.</span><span class="n">species_definitions</span><span class="p">[</span><span class="n">sp</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;frequencies&#39;</span><span class="p">,[])</span>
        <span class="n">frequency_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequency_dict</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="k">if</span> <span class="p">(</span>
                <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s">&#39;_current_state&#39;</span><span class="p">,</span><span class="bp">None</span><span class="p">)</span> <span class="o">==</span> <span class="n">current_state</span> <span class="ow">and</span> 
                <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s">&#39;_frequency_dict&#39;</span><span class="p">,</span><span class="bp">None</span><span class="p">)</span> <span class="o">==</span> <span class="n">frequency_dict</span> <span class="ow">and</span>
                <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">force_recalculation</span>
                <span class="p">):</span> <span class="c">#if the thermodynamic state (and frequencies) </span>
            <span class="c">#has not changed then don&#39;t bother re-calculating the corrections.</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_correction_dict</span>

        <span class="n">correction_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_correction_dict</span> <span class="o">=</span> <span class="n">correction_dict</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_current_state</span> <span class="o">=</span> <span class="n">current_state</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_frequency_dict</span> <span class="o">=</span> <span class="n">frequency_dict</span>

        <span class="c"># apply corrections in self.thermodynamic_corrections on top of each other</span>
        <span class="k">for</span> <span class="n">correction</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">thermodynamic_corrections</span><span class="p">:</span>
            <span class="n">mode</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">correction</span><span class="o">+</span><span class="s">&#39;_thermo_mode&#39;</span><span class="p">)</span>
            <span class="n">thermo_dict</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mode</span><span class="p">)()</span>
            <span class="n">add_dict_in_place</span><span class="p">(</span><span class="n">correction_dict</span><span class="p">,</span> <span class="n">thermo_dict</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pressure_mode</span><span class="p">:</span>
            <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">pressure_mode</span><span class="o">+</span><span class="s">&#39;_pressure&#39;</span><span class="p">)()</span>

        <span class="k">if</span> <span class="s">&#39;electrochemical&#39;</span> <span class="ow">in</span> <span class="n">l</span><span class="p">:</span>
            <span class="n">correction_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_echem_corrections</span><span class="p">(</span><span class="n">correction_dict</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">correction_dict</span>
</div>
<div class="viewcode-block" id="ThermoCorrections._get_echem_corrections"><a class="viewcode-back" href="../../../reference/catmap.thermodynamics.html#catmap.thermodynamics.enthalpy_entropy.ThermoCorrections._get_echem_corrections">[docs]</a>    <span class="k">def</span> <span class="nf">_get_echem_corrections</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">correction_dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Perform the thermodynamic corrections relevant to electrochemistry but</span>
<span class="sd">        are not specific to any particular mode.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Generate energy for fake echem transition states after all other corrections</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">echem_transition_state_names</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">echem_thermo_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_echem_TS_energies</span><span class="p">()</span>
            <span class="n">add_dict_in_place</span><span class="p">(</span><span class="n">correction_dict</span><span class="p">,</span> <span class="n">echem_thermo_dict</span><span class="p">)</span>

        <span class="c"># pH corrections to proton and hydroxide species</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pH</span><span class="p">:</span>
            <span class="n">proton_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proton_species</span> <span class="ow">or</span> <span class="s">&#39;H_g&#39;</span><span class="p">)</span>
            <span class="n">hydroxide_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hydroxide_species</span> <span class="ow">or</span> <span class="s">&#39;OH_g&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gas_pressures</span><span class="p">[</span><span class="n">proton_index</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">/</span> <span class="mi">10</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">pH</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gas_pressures</span><span class="p">[</span><span class="n">hydroxide_index</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1e-14</span> <span class="o">*</span> <span class="mi">10</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">pH</span>

        <span class="c"># pressure corrections to species in the echem double layer based on kH</span>
        <span class="k">if</span> <span class="s">&#39;dl&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species_definitions</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">dl_species</span> <span class="o">=</span> <span class="p">[</span><span class="n">spec</span> <span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species_definitions</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
                            <span class="k">if</span> <span class="s">&#39;_dl&#39;</span> <span class="ow">in</span> <span class="n">spec</span> <span class="ow">and</span> <span class="s">&#39;*&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">spec</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">spec</span> <span class="ow">in</span> <span class="n">dl_species</span><span class="p">:</span>
            	<span class="n">tempname</span> <span class="o">=</span> <span class="n">spec</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            	<span class="n">gas_spec</span> <span class="o">=</span> <span class="n">tempname</span><span class="o">+</span><span class="s">&#39;_g&#39;</span>
            	<span class="n">C_H2O</span> <span class="o">=</span> <span class="mf">55.</span>
            	<span class="n">KH_gas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">species_definitions</span><span class="p">[</span><span class="n">spec</span><span class="p">][</span><span class="s">&#39;kH&#39;</span><span class="p">]</span>
            	<span class="n">P_gas</span> <span class="o">=</span> <span class="n">C_H2O</span> <span class="o">/</span> <span class="n">KH_gas</span>
            	<span class="n">P_corr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">P_gas</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_kB</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature</span>
            	<span class="n">correction_dict</span><span class="p">[</span><span class="n">spec</span><span class="p">]</span> <span class="o">=</span> <span class="n">correction_dict</span><span class="p">[</span><span class="n">gas_spec</span><span class="p">]</span> <span class="o">+</span> <span class="n">P_corr</span>
            	
        <span class="k">return</span> <span class="n">correction_dict</span>
</div>
<div class="viewcode-block" id="ThermoCorrections.ideal_gas"><a class="viewcode-back" href="../../../reference/catmap.thermodynamics.html#catmap.thermodynamics.enthalpy_entropy.ThermoCorrections.ideal_gas">[docs]</a>    <span class="k">def</span> <span class="nf">ideal_gas</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate the thermal correction to the free energy of </span>
<span class="sd">        an ideal gas using the IdealGasThermo class in ase.thermochemistry </span>
<span class="sd">        along with the molecular structures in ase.data.molecules.</span>

<span class="sd">        gas_names = the chemical formulas of the gasses of interest (usually </span>
<span class="sd">            ending in _g to denote that they are in the gas phase).</span>
<span class="sd">        freq_dict = dictionary of vibrational frequencies for each gas </span>
<span class="sd">            of interest. Vibrational frequencies should be in eV. </span>
<span class="sd">            The dictionary should be of the form </span>
<span class="sd">            freq_dict[gas_name] = [freq1, freq2, ...]</span>
<span class="sd">        ideal_gas_params = dictionary of the symetry number, </span>
<span class="sd">            geometry keyword, and spin of the gas. If no dictionary </span>
<span class="sd">            is specified then the function will attempt to look the </span>
<span class="sd">            gas up in the hard-coded gas_params dictionary. </span>
<span class="sd">            The dictionary should be of the form </span>
<span class="sd">            ideal_gas_params[gas_name] = [symmetry_number,geometry, spin]</span>
<span class="sd">        atoms_dict = dictionary of ase atoms objects to use for </span>
<span class="sd">            calculating rotational contributions. If none is specified </span>
<span class="sd">            then the function will look in ase.data.molecules.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">freq_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequency_dict</span>
        <span class="n">gas_param_dict</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ideal_gas_params</span>
        <span class="n">temperature</span><span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temperature</span><span class="p">)</span>
        <span class="n">gas_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_names</span>

        <span class="n">thermo_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">temperature</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="n">temperature</span> <span class="o">=</span> <span class="mf">1e-99</span>

        <span class="n">gas_renames</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;CH2O_g&#39;</span><span class="p">:</span><span class="s">&#39;H2CO_g&#39;</span><span class="p">}</span>

        <span class="n">ase_atoms_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">gas</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_names</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">gas</span> <span class="ow">in</span> <span class="n">gas_renames</span><span class="p">:</span>
                <span class="n">atom_name</span> <span class="o">=</span> <span class="n">gas_renames</span><span class="p">[</span><span class="n">gas</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;_g&#39;</span><span class="p">,</span><span class="s">&#39;&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">atom_name</span> <span class="o">=</span> <span class="n">gas</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;_g&#39;</span><span class="p">,</span><span class="s">&#39;&#39;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">ase_atoms_dict</span><span class="p">[</span><span class="n">gas</span><span class="p">]</span> <span class="o">=</span> <span class="n">molecule</span><span class="p">(</span><span class="n">atom_name</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="n">ase_atoms_dict</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms_dict</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atoms_dict</span> <span class="o">=</span> <span class="n">ase_atoms_dict</span>
        <span class="n">atoms_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms_dict</span>

        <span class="k">for</span> <span class="n">gas</span> <span class="ow">in</span> <span class="n">gas_names</span><span class="p">:</span>
            <span class="c"># Hard coding corrections for fictitious gas molecules used in echem</span>
            <span class="k">if</span> <span class="n">gas</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;pe_g&#39;</span><span class="p">,</span> <span class="s">&#39;ele_g&#39;</span><span class="p">,</span> <span class="s">&#39;H_g&#39;</span><span class="p">,</span> <span class="s">&#39;OH_g&#39;</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">proton_species</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">hydroxide_species</span><span class="p">]:</span>
                <span class="n">thermo_dict</span><span class="p">[</span><span class="n">gas</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_zpe_dict</span><span class="p">[</span><span class="n">gas</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_enthalpy_dict</span><span class="p">[</span><span class="n">gas</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_entropy_dict</span><span class="p">[</span><span class="n">gas</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>
                <span class="k">continue</span>
            <span class="n">gpars</span> <span class="o">=</span> <span class="n">gas_param_dict</span><span class="p">[</span><span class="n">gas</span><span class="p">]</span>
            <span class="n">symmetry</span><span class="p">,</span><span class="n">geometry</span><span class="p">,</span><span class="n">spin</span> <span class="o">=</span> <span class="n">gpars</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
            <span class="n">fugacity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bar2Pa</span>
            <span class="c">#Pressures should not be used in microkinetic </span>
            <span class="c">#modelling; they are implicitly included in the </span>
            <span class="c">#rate expressions via the thermodynamic derivations.</span>

            <span class="n">atoms</span> <span class="o">=</span> <span class="n">atoms_dict</span><span class="p">[</span><span class="n">gas</span><span class="p">]</span>
            <span class="n">therm</span> <span class="o">=</span> <span class="n">IdealGasThermo</span><span class="p">(</span>
                    <span class="n">freq_dict</span><span class="p">[</span><span class="n">gas</span><span class="p">],</span> <span class="n">geometry</span><span class="p">,</span> 
                    <span class="n">atoms</span><span class="o">=</span><span class="n">atoms</span><span class="p">,</span> <span class="n">symmetrynumber</span><span class="o">=</span><span class="n">symmetry</span><span class="p">,</span> 
                    <span class="n">spin</span><span class="o">=</span><span class="n">spin</span><span class="p">)</span>

            <span class="n">ZPE</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">freq_dict</span><span class="p">[</span><span class="n">gas</span><span class="p">]))</span>

            <span class="n">H</span> <span class="o">=</span> <span class="n">therm</span><span class="o">.</span><span class="n">get_enthalpy</span><span class="p">(</span><span class="n">temperature</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
            <span class="n">S</span> <span class="o">=</span> <span class="n">therm</span><span class="o">.</span><span class="n">get_entropy</span><span class="p">(</span>
                    <span class="n">temperature</span><span class="p">,</span> <span class="n">fugacity</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

            <span class="n">free_energy</span> <span class="o">=</span> <span class="n">H</span><span class="o">-</span><span class="n">temperature</span><span class="o">*</span><span class="n">S</span>
            <span class="n">thermo_dict</span><span class="p">[</span><span class="n">gas</span><span class="p">]</span> <span class="o">=</span> <span class="n">free_energy</span> <span class="c">#use thermodynamic state </span>
                    <span class="c">#from ase.thermochemistry to calculate thermal corrections.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_zpe_dict</span><span class="p">[</span><span class="n">gas</span><span class="p">]</span> <span class="o">=</span> <span class="n">ZPE</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_enthalpy_dict</span><span class="p">[</span><span class="n">gas</span><span class="p">]</span> <span class="o">=</span> <span class="n">H</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_entropy_dict</span><span class="p">[</span><span class="n">gas</span><span class="p">]</span> <span class="o">=</span> <span class="n">S</span>

        <span class="k">return</span> <span class="n">thermo_dict</span>
</div>
<div class="viewcode-block" id="ThermoCorrections.shomate_gas"><a class="viewcode-back" href="../../../reference/catmap.thermodynamics.html#catmap.thermodynamics.enthalpy_entropy.ThermoCorrections.shomate_gas">[docs]</a>    <span class="k">def</span> <span class="nf">shomate_gas</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Calculate free energy corrections using shomate equation</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="n">gas_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_names</span>
        <span class="n">temperature</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temperature</span><span class="p">)</span>
        <span class="n">temperature_ref</span> <span class="o">=</span> <span class="mf">298.15</span>

        <span class="n">shomate_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shomate_params</span>

        <span class="k">def</span> <span class="nf">H</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">params</span><span class="p">):</span>
            <span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">E</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">G</span><span class="p">,</span><span class="n">H</span> <span class="o">=</span> <span class="n">params</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">T</span><span class="o">/</span><span class="mf">1000.0</span>
            <span class="n">H</span> <span class="o">=</span> <span class="n">A</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="p">(</span><span class="n">B</span><span class="o">/</span><span class="mf">2.0</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">C</span><span class="o">/</span><span class="mf">3.0</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="p">(</span><span class="n">D</span><span class="o">/</span><span class="mf">4.0</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">E</span><span class="o">/</span><span class="n">t</span> <span class="o">+</span> <span class="n">F</span> <span class="o">-</span> <span class="n">H</span> 
            <span class="c">#kJ/mol</span>
            <span class="k">return</span> <span class="n">H</span>

        <span class="k">def</span> <span class="nf">S</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">params</span><span class="p">):</span>
            <span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">E</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">G</span><span class="p">,</span><span class="n">H</span> <span class="o">=</span> <span class="n">params</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">T</span><span class="o">/</span><span class="mf">1000.0</span>
            <span class="n">S</span> <span class="o">=</span> <span class="n">A</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">B</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="p">(</span><span class="n">C</span><span class="o">/</span><span class="mf">2.0</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">D</span><span class="o">/</span><span class="mf">3.0</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="n">E</span><span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> \
                    <span class="o">+</span> <span class="n">G</span> <span class="c">#J/mol*K</span>
            <span class="k">return</span> <span class="n">S</span>

        <span class="k">def</span> <span class="nf">Cp</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">params</span><span class="p">):</span>
            <span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">E</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">G</span><span class="p">,</span><span class="n">H</span> <span class="o">=</span> <span class="n">params</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">T</span><span class="o">/</span><span class="mf">1000.0</span>
            <span class="n">Cp</span> <span class="o">=</span> <span class="n">A</span> <span class="o">+</span> <span class="n">B</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">C</span><span class="o">*</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">D</span><span class="o">*</span><span class="n">t</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span><span class="n">E</span><span class="o">/</span><span class="p">(</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">Cp</span>
        
        <span class="n">thermo_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">gas</span> <span class="ow">in</span> <span class="n">gas_names</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">shomate_params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">gas_key</span><span class="p">,</span><span class="n">T_range</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;:&#39;</span><span class="p">)</span>
                <span class="n">T_min</span><span class="p">,</span><span class="n">T_max</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">T_range</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;-&#39;</span><span class="p">)]</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">gas</span> <span class="o">==</span> <span class="n">gas_key</span> 
                        <span class="ow">and</span> <span class="n">temperature</span> <span class="o">&gt;=</span> <span class="n">T_min</span> 
                        <span class="ow">and</span> <span class="n">temperature</span> <span class="o">&lt;=</span> <span class="n">T_max</span>
                        <span class="p">):</span>
                    <span class="n">params</span> <span class="o">=</span> <span class="n">shomate_params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                    <span class="n">Cp_ref</span> <span class="o">=</span> <span class="n">Cp</span><span class="p">(</span><span class="n">temperature_ref</span><span class="p">,</span><span class="n">params</span><span class="p">)</span>
                    <span class="n">dH</span> <span class="o">=</span> <span class="n">H</span><span class="p">(</span><span class="n">temperature</span><span class="p">,</span><span class="n">params</span><span class="p">)</span> <span class="o">-</span> <span class="n">H</span><span class="p">(</span><span class="n">temperature_ref</span><span class="p">,</span><span class="n">params</span><span class="p">)</span>
                    <span class="c">#deltaH(298-T) = shomate(T) - shomate(298)</span>
                    <span class="n">dS</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="n">temperature</span><span class="p">,</span><span class="n">params</span><span class="p">)</span>
                    <span class="n">dH</span> <span class="o">=</span> <span class="p">(</span><span class="n">temperature_ref</span><span class="o">*</span><span class="n">Cp_ref</span><span class="o">/</span><span class="mf">1000.0</span> <span class="o">+</span> <span class="n">dH</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_kJmol2eV</span><span class="p">)</span> <span class="c">#eV</span>
                    <span class="c">#dH = 298*Cp(298) + dH(298-T)</span>
                    <span class="n">dS</span> <span class="o">=</span> <span class="n">dS</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_kJmol2eV</span><span class="o">/</span><span class="mf">1e3</span><span class="p">)</span> <span class="c">#eV/K</span>
                    <span class="n">ZPE</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frequency_dict</span><span class="p">[</span><span class="n">gas</span><span class="p">])</span><span class="o">/</span><span class="mf">2.0</span> 
                    <span class="n">free_energy</span> <span class="o">=</span> <span class="n">ZPE</span> <span class="o">+</span>  <span class="n">dH</span> <span class="o">-</span> <span class="n">temperature</span><span class="o">*</span><span class="n">dS</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_zpe_dict</span><span class="p">[</span><span class="n">gas</span><span class="p">]</span> <span class="o">=</span> <span class="n">ZPE</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_enthalpy_dict</span><span class="p">[</span><span class="n">gas</span><span class="p">]</span> <span class="o">=</span> <span class="n">dH</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_entropy_dict</span><span class="p">[</span><span class="n">gas</span><span class="p">]</span> <span class="o">=</span> <span class="n">dS</span>
                    <span class="n">thermo_dict</span><span class="p">[</span><span class="n">gas</span><span class="p">]</span> <span class="o">=</span> <span class="n">free_energy</span>
                <span class="k">elif</span> <span class="n">temperature</span> <span class="o">&lt;</span> <span class="n">T_min</span> <span class="ow">and</span> <span class="n">T_min</span> <span class="o">&lt;</span> <span class="mi">300</span><span class="p">:</span>
                    <span class="n">params</span> <span class="o">=</span> <span class="n">shomate_params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                    <span class="n">Cp_ref</span> <span class="o">=</span> <span class="n">Cp</span><span class="p">(</span><span class="n">T_min</span><span class="p">,</span><span class="n">params</span><span class="p">)</span>
                    <span class="n">dS</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="n">T_min</span><span class="p">,</span><span class="n">params</span><span class="p">)</span>
                    <span class="n">dH</span> <span class="o">=</span> <span class="p">(</span><span class="n">temperature</span><span class="o">*</span><span class="n">Cp_ref</span><span class="o">/</span><span class="mf">1000.0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_kJmol2eV</span><span class="p">)</span> <span class="c">#eV</span>
                    <span class="n">dS</span> <span class="o">=</span> <span class="n">dS</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_kJmol2eV</span><span class="o">/</span><span class="mf">1e3</span><span class="p">)</span> <span class="c">#eV/K</span>
                    <span class="n">ZPE</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frequency_dict</span><span class="p">[</span><span class="n">gas</span><span class="p">])</span><span class="o">/</span><span class="mf">2.0</span> 
                    <span class="n">free_energy</span> <span class="o">=</span> <span class="n">ZPE</span> <span class="o">+</span>  <span class="n">dH</span> <span class="o">-</span> <span class="n">temperature</span><span class="o">*</span><span class="n">dS</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_zpe_dict</span><span class="p">[</span><span class="n">gas</span><span class="p">]</span> <span class="o">=</span> <span class="n">ZPE</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_enthalpy_dict</span><span class="p">[</span><span class="n">gas</span><span class="p">]</span> <span class="o">=</span> <span class="n">dH</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_entropy_dict</span><span class="p">[</span><span class="n">gas</span><span class="p">]</span> <span class="o">=</span> <span class="n">dS</span>
                    <span class="n">thermo_dict</span><span class="p">[</span><span class="n">gas</span><span class="p">]</span> <span class="o">=</span> <span class="n">free_energy</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;shomate_warning&#39;</span><span class="p">,</span><span class="n">gas</span><span class="o">=</span><span class="n">gas</span><span class="p">,</span><span class="n">T</span><span class="o">=</span><span class="n">T_min</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">gas_names</span><span class="p">:</span>
            <span class="n">not_there</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">thermo_dict</span><span class="p">:</span>
                <span class="n">not_there</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">not_there</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;No Shomate parameters specified for &#39;</span><span class="o">+</span><span class="s">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">not_there</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">thermo_dict</span>
</div>
<div class="viewcode-block" id="ThermoCorrections.fixed_entropy_gas"><a class="viewcode-back" href="../../../reference/catmap.thermodynamics.html#catmap.thermodynamics.enthalpy_entropy.ThermoCorrections.fixed_entropy_gas">[docs]</a>    <span class="k">def</span> <span class="nf">fixed_entropy_gas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">include_ZPE</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Add entropy based on fixed_entropy_dict (entropy contribution to free energy assumed linear with temperature) and ZPE </span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="n">thermo_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">gas_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_names</span>
        <span class="n">temperature</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature</span>
        <span class="n">entropy_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fixed_entropy_dict</span>
        <span class="k">if</span> <span class="n">temperature</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="n">temperature</span> <span class="o">=</span> <span class="mf">1e-99</span>

        <span class="n">freq_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequency_dict</span>

        <span class="k">for</span> <span class="n">gas</span> <span class="ow">in</span> <span class="n">gas_names</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">include_ZPE</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
                <span class="n">ZPE</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">freq_dict</span><span class="p">[</span><span class="n">gas</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ZPE</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="n">gas</span> <span class="ow">in</span> <span class="n">entropy_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">S</span> <span class="o">=</span> <span class="n">entropy_dict</span><span class="p">[</span><span class="n">gas</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">S</span> <span class="o">=</span> <span class="n">entropy_dict</span><span class="p">[</span><span class="s">&#39;other&#39;</span><span class="p">]</span>
            <span class="n">free_energy</span> <span class="o">=</span> <span class="n">ZPE</span><span class="o">-</span><span class="n">temperature</span><span class="o">*</span><span class="n">S</span>
            <span class="n">thermo_dict</span><span class="p">[</span><span class="n">gas</span><span class="p">]</span> <span class="o">=</span> <span class="n">free_energy</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_zpe_dict</span><span class="p">[</span><span class="n">gas</span><span class="p">]</span> <span class="o">=</span> <span class="n">ZPE</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_enthalpy_dict</span><span class="p">[</span><span class="n">gas</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_entropy_dict</span><span class="p">[</span><span class="n">gas</span><span class="p">]</span> <span class="o">=</span> <span class="n">S</span>
        <span class="k">return</span> <span class="n">thermo_dict</span>
</div>
<div class="viewcode-block" id="ThermoCorrections.frozen_fixed_entropy_gas"><a class="viewcode-back" href="../../../reference/catmap.thermodynamics.html#catmap.thermodynamics.enthalpy_entropy.ThermoCorrections.frozen_fixed_entropy_gas">[docs]</a>    <span class="k">def</span> <span class="nf">frozen_fixed_entropy_gas</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Do not add ZPE, calculate fixed entropy correction.</span>
<span class="sd">	&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fixed_entropy_gas</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ThermoCorrections.zero_point_gas"><a class="viewcode-back" href="../../../reference/catmap.thermodynamics.html#catmap.thermodynamics.enthalpy_entropy.ThermoCorrections.zero_point_gas">[docs]</a>    <span class="k">def</span> <span class="nf">zero_point_gas</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Add zero point energy correction to gasses.</span>
<span class="sd">	&quot;&quot;&quot;</span>
        <span class="n">gas_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_names</span>
        <span class="n">freq_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequency_dict</span>
        <span class="n">thermo_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">gas</span> <span class="ow">in</span> <span class="n">gas_names</span><span class="p">:</span>
            <span class="n">ZPE</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">freq_dict</span><span class="p">[</span><span class="n">gas</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_zpe_dict</span><span class="p">[</span><span class="n">gas</span><span class="p">]</span> <span class="o">=</span> <span class="n">ZPE</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_enthalpy_dict</span><span class="p">[</span><span class="n">gas</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_entropy_dict</span><span class="p">[</span><span class="n">gas</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">thermo_dict</span><span class="p">[</span><span class="n">gas</span><span class="p">]</span> <span class="o">=</span> <span class="n">ZPE</span>
        <span class="k">return</span> <span class="n">thermo_dict</span>
</div>
<div class="viewcode-block" id="ThermoCorrections.frozen_gas"><a class="viewcode-back" href="../../../reference/catmap.thermodynamics.html#catmap.thermodynamics.enthalpy_entropy.ThermoCorrections.frozen_gas">[docs]</a>    <span class="k">def</span> <span class="nf">frozen_gas</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Neglect all thermal contributions, including the zero point energy.</span>
<span class="sd">	&quot;&quot;&quot;</span>
        <span class="n">gas_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_names</span>
        <span class="n">thermo_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">gas</span> <span class="ow">in</span> <span class="n">gas_names</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_zpe_dict</span><span class="p">[</span><span class="n">gas</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_enthalpy_dict</span><span class="p">[</span><span class="n">gas</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_entropy_dict</span><span class="p">[</span><span class="n">gas</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">thermo_dict</span><span class="p">[</span><span class="n">gas</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="n">thermo_dict</span>
</div>
<div class="viewcode-block" id="ThermoCorrections.fixed_enthalpy_entropy_gas"><a class="viewcode-back" href="../../../reference/catmap.thermodynamics.html#catmap.thermodynamics.enthalpy_entropy.ThermoCorrections.fixed_enthalpy_entropy_gas">[docs]</a>    <span class="k">def</span> <span class="nf">fixed_enthalpy_entropy_gas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">gas_names</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Calculate free energy corrections based on input enthalpy, entropy, ZPE</span>
<span class="sd">	&quot;&quot;&quot;</span>
        <span class="n">thermo_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">gas_names</span><span class="p">:</span>
            <span class="n">gas_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_names</span>
        <span class="k">for</span> <span class="n">gas</span> <span class="ow">in</span> <span class="n">gas_names</span><span class="p">:</span>
            <span class="n">G</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">species_def</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">species_definitions</span><span class="p">[</span><span class="n">gas</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;zero_point_energy&#39;</span><span class="p">,</span><span class="s">&#39;enthalpy&#39;</span><span class="p">,</span><span class="s">&#39;entropy&#39;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">species_def</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="s">&#39;Warning: No &#39;</span><span class="o">+</span><span class="n">key</span><span class="o">+</span><span class="s">&#39; found for &#39;</span><span class="o">+</span><span class="n">gas</span><span class="o">+</span><span class="s">&#39;. Using 0&#39;</span><span class="p">)</span>
            <span class="n">ZPE</span> <span class="o">=</span> <span class="n">species_def</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;zero_point_energy&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">enthalpy</span> <span class="o">=</span> <span class="n">species_def</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;enthalpy&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">entropy</span> <span class="o">=</span> <span class="n">species_def</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;entropy&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_zpe_dict</span><span class="p">[</span><span class="n">gas</span><span class="p">]</span> <span class="o">=</span> <span class="n">ZPE</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_enthalpy_dict</span><span class="p">[</span><span class="n">gas</span><span class="p">]</span> <span class="o">=</span> <span class="n">enthalpy</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_entropy_dict</span><span class="p">[</span><span class="n">gas</span><span class="p">]</span> <span class="o">=</span> <span class="n">entropy</span>
            <span class="n">thermo_dict</span><span class="p">[</span><span class="n">gas</span><span class="p">]</span> <span class="o">=</span> <span class="n">ZPE</span> <span class="o">+</span> <span class="n">enthalpy</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature</span><span class="o">*</span><span class="n">entropy</span>
        <span class="k">return</span> <span class="n">thermo_dict</span>
</div>
<div class="viewcode-block" id="ThermoCorrections.harmonic_adsorbate"><a class="viewcode-back" href="../../../reference/catmap.thermodynamics.html#catmap.thermodynamics.enthalpy_entropy.ThermoCorrections.harmonic_adsorbate">[docs]</a>    <span class="k">def</span> <span class="nf">harmonic_adsorbate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate the thermal correction to the free energy of </span>
<span class="sd">        an adsorbate in the harmonic approximation using the HarmonicThermo </span>
<span class="sd">        class in ase.thermochemistry.</span>

<span class="sd">        adsorbate_names = the chemical formulas of the gasses of interest </span>
<span class="sd">            (usually ending in _g to denote that they are in the gas phase).</span>
<span class="sd">        freq_dict = dictionary of vibrational frequencies for each gas of </span>
<span class="sd">            interest. Vibrational frequencies should be in eV. The dictionary </span>
<span class="sd">            should be of the form freq_dict[gas_name] = [freq1, freq2, ...]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">adsorbate_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">adsorbate_names</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">transition_state_names</span>
        <span class="n">temperature</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temperature</span><span class="p">)</span>
        <span class="n">freq_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequency_dict</span>

        <span class="n">thermo_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">temperature</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="n">temperature</span> <span class="o">=</span> <span class="mf">1e-99</span>

        <span class="n">avg_TS</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_freq_cutoffs</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">ads</span> <span class="ow">in</span> <span class="n">adsorbate_names</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ads</span> <span class="ow">in</span> <span class="n">freq_dict</span><span class="p">:</span>
                <span class="k">if</span> <span class="s">&#39;-&#39;</span> <span class="ow">in</span> <span class="n">ads</span> <span class="ow">and</span> <span class="n">freq_dict</span><span class="p">[</span><span class="n">ads</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">None</span><span class="p">,[],()]:</span>
                    <span class="n">avg_TS</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ads</span><span class="p">)</span>
                <span class="n">frequencies</span> <span class="o">=</span> <span class="n">freq_dict</span><span class="p">[</span><span class="n">ads</span><span class="p">]</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_entropy_per_mode</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">temperature</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_freq_cutoffs</span><span class="p">:</span>
                        <span class="n">nu_min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_freq_cutoffs</span><span class="p">[</span><span class="n">temperature</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">kB_multiplier</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_entropy_per_mode</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">_kB</span><span class="p">)</span>
                        <span class="n">nu_min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_frequency_cutoff</span><span class="p">(</span><span class="n">kB_multiplier</span><span class="p">,</span><span class="nb">float</span><span class="p">(</span><span class="n">temperature</span><span class="p">))</span>
                        <span class="n">nu_min</span> <span class="o">/=</span> <span class="mf">1000.</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_freq_cutoffs</span><span class="p">[</span><span class="n">temperature</span><span class="p">]</span> <span class="o">=</span> <span class="n">nu_min</span>

                    <span class="n">frequencies</span> <span class="o">=</span> <span class="p">[</span><span class="nb">max</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span><span class="n">nu_min</span><span class="p">)</span> <span class="k">for</span> <span class="n">nu</span> <span class="ow">in</span> <span class="n">frequencies</span><span class="p">]</span>
                <span class="n">therm</span> <span class="o">=</span> <span class="n">HarmonicThermo</span><span class="p">(</span><span class="n">frequencies</span><span class="p">)</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">free_energy</span> <span class="o">=</span> <span class="n">therm</span><span class="o">.</span><span class="n">get_gibbs_energy</span><span class="p">(</span>
                            <span class="n">temperature</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s">&#39;HarmonicThermo.get_free_energy is deprecated.&#39;</span>
                                   <span class="s">&#39;Update your ASE version.&#39;</span><span class="p">)</span>
                    <span class="n">free_energy</span> <span class="o">=</span> <span class="n">therm</span><span class="o">.</span><span class="n">get_free_energy</span><span class="p">(</span>
                            <span class="n">temperature</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
                <span class="n">ZPE</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">frequencies</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span> 
                <span class="n">dS</span> <span class="o">=</span> <span class="n">therm</span><span class="o">.</span><span class="n">get_entropy</span><span class="p">(</span><span class="n">temperature</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
                <span class="n">dH</span> <span class="o">=</span> <span class="n">therm</span><span class="o">.</span><span class="n">get_internal_energy</span><span class="p">(</span><span class="n">temperature</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span> <span class="o">-</span> <span class="n">ZPE</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_zpe_dict</span><span class="p">[</span><span class="n">ads</span><span class="p">]</span> <span class="o">=</span> <span class="n">ZPE</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_enthalpy_dict</span><span class="p">[</span><span class="n">ads</span><span class="p">]</span> <span class="o">=</span> <span class="n">dH</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_entropy_dict</span><span class="p">[</span><span class="n">ads</span><span class="p">]</span> <span class="o">=</span> <span class="n">dS</span>
                <span class="n">thermo_dict</span><span class="p">[</span><span class="n">ads</span><span class="p">]</span> <span class="o">=</span> <span class="n">free_energy</span> <span class="c">#use thermodynamic state from </span>
                <span class="c">#ase.thermochemistry to calculate thermal corrections.</span>
            <span class="k">elif</span> <span class="s">&#39;-&#39;</span> <span class="ow">in</span> <span class="n">ads</span><span class="p">:</span>
                <span class="n">avg_TS</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ads</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s">&#39;Missing vibrational frequencies for &#39;</span><span class="o">+</span><span class="n">ads</span><span class="p">)</span>

        <span class="n">ts_thermo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">average_transition_state</span><span class="p">(</span><span class="n">thermo_dict</span><span class="p">,</span><span class="n">avg_TS</span><span class="p">)</span>
        <span class="n">thermo_dict</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">ts_thermo</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">thermo_dict</span>
    </div>
<div class="viewcode-block" id="ThermoCorrections.zero_point_adsorbate"><a class="viewcode-back" href="../../../reference/catmap.thermodynamics.html#catmap.thermodynamics.enthalpy_entropy.ThermoCorrections.zero_point_adsorbate">[docs]</a>    <span class="k">def</span> <span class="nf">zero_point_adsorbate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Add zero point energy correction to adsorbate energy.</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="n">adsorbate_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">adsorbate_names</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">transition_state_names</span>
        <span class="n">freq_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequency_dict</span>
        <span class="n">thermo_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">avg_TS</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ads</span> <span class="ow">in</span> <span class="n">adsorbate_names</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">freq_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ads</span><span class="p">,</span><span class="bp">None</span><span class="p">):</span>
                <span class="n">ZPE</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">freq_dict</span><span class="p">[</span><span class="n">ads</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_zpe_dict</span><span class="p">[</span><span class="n">ads</span><span class="p">]</span> <span class="o">=</span> <span class="n">ZPE</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_enthalpy_dict</span><span class="p">[</span><span class="n">ads</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_entropy_dict</span><span class="p">[</span><span class="n">ads</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">thermo_dict</span><span class="p">[</span><span class="n">ads</span><span class="p">]</span> <span class="o">=</span> <span class="n">ZPE</span>
            <span class="k">elif</span> <span class="s">&#39;-&#39;</span> <span class="ow">in</span> <span class="n">ads</span><span class="p">:</span>
                <span class="n">avg_TS</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ads</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s">&#39;Missing vibrational frequencies for &#39;</span><span class="o">+</span><span class="n">ads</span><span class="p">)</span>

        <span class="n">ts_thermo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">average_transition_state</span><span class="p">(</span><span class="n">thermo_dict</span><span class="p">,</span><span class="n">avg_TS</span><span class="p">)</span>
        <span class="n">thermo_dict</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">ts_thermo</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">thermo_dict</span>
</div>
<div class="viewcode-block" id="ThermoCorrections.frozen_adsorbate"><a class="viewcode-back" href="../../../reference/catmap.thermodynamics.html#catmap.thermodynamics.enthalpy_entropy.ThermoCorrections.frozen_adsorbate">[docs]</a>    <span class="k">def</span> <span class="nf">frozen_adsorbate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Neglect all zero point, enthalpy, entropy corrections to adsorbate energy.</span>
<span class="sd">	&quot;&quot;&quot;</span>
        <span class="n">thermo_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">ads</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">adsorbate_names</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">transition_state_names</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_zpe_dict</span><span class="p">[</span><span class="n">ads</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_enthalpy_dict</span><span class="p">[</span><span class="n">ads</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_entropy_dict</span><span class="p">[</span><span class="n">ads</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">thermo_dict</span><span class="p">[</span><span class="n">ads</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="n">thermo_dict</span>
</div>
<div class="viewcode-block" id="ThermoCorrections.fixed_enthalpy_entropy_adsorbate"><a class="viewcode-back" href="../../../reference/catmap.thermodynamics.html#catmap.thermodynamics.enthalpy_entropy.ThermoCorrections.fixed_enthalpy_entropy_adsorbate">[docs]</a>    <span class="k">def</span> <span class="nf">fixed_enthalpy_entropy_adsorbate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Return free energy corrections based on input enthalpy, entropy, ZPE</span>
<span class="sd">	&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fixed_enthalpy_entropy_gas</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">adsorbate_names</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">transition_state_names</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="ThermoCorrections.average_transition_state"><a class="viewcode-back" href="../../../reference/catmap.thermodynamics.html#catmap.thermodynamics.enthalpy_entropy.ThermoCorrections.average_transition_state">[docs]</a>    <span class="k">def</span> <span class="nf">average_transition_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">thermo_dict</span><span class="p">,</span><span class="n">transition_state_list</span> <span class="o">=</span> <span class="p">[]):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Return transition state thermochemical corrections as average of IS and FS corrections </span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="k">if</span> <span class="n">transition_state_list</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">transition_state_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transition_state_names</span>

        <span class="k">def</span> <span class="nf">state_thermo</span><span class="p">(</span><span class="n">therm_dict</span><span class="p">,</span><span class="n">rx</span><span class="p">,</span><span class="n">site_defs</span><span class="p">,</span><span class="n">rx_id</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">sum</span><span class="p">([</span><span class="n">therm_dict</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">rx</span><span class="p">[</span><span class="n">rx_id</span><span class="p">]</span> <span class="k">if</span> <span class="p">(</span>
                            <span class="n">s</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">site_defs</span> <span class="ow">and</span> <span class="ow">not</span> 
                            <span class="n">s</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s">&#39;_g&#39;</span><span class="p">))])</span>

        <span class="k">for</span> <span class="n">ads</span> <span class="ow">in</span> <span class="n">transition_state_list</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s">&#39;harmonic_transition_state_warning&#39;</span><span class="p">,</span><span class="n">TS</span><span class="o">=</span><span class="n">ads</span><span class="p">)</span>
            <span class="n">rx</span> <span class="o">=</span> <span class="p">[</span><span class="n">rx</span> <span class="k">for</span> <span class="n">rx</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elementary_rxns</span> <span class="k">if</span> <span class="n">ads</span> <span class="ow">in</span> <span class="n">rx</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">therm_dict</span> <span class="ow">in</span> <span class="p">[</span><span class="n">thermo_dict</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_zpe_dict</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_enthalpy_dict</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_entropy_dict</span><span class="p">]:</span>
                <span class="n">IS</span> <span class="o">=</span> <span class="n">state_thermo</span><span class="p">(</span><span class="n">therm_dict</span><span class="p">,</span><span class="n">rx</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">site_names</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">FS</span> <span class="o">=</span> <span class="n">state_thermo</span><span class="p">(</span><span class="n">therm_dict</span><span class="p">,</span><span class="n">rx</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">site_names</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">therm_dict</span><span class="p">[</span><span class="n">ads</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">IS</span><span class="o">+</span><span class="n">FS</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span>
        <span class="k">return</span> <span class="n">thermo_dict</span>
</div>
<div class="viewcode-block" id="ThermoCorrections.generate_echem_TS_energies"><a class="viewcode-back" href="../../../reference/catmap.thermodynamics.html#catmap.thermodynamics.enthalpy_entropy.ThermoCorrections.generate_echem_TS_energies">[docs]</a>    <span class="k">def</span> <span class="nf">generate_echem_TS_energies</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">	Give real energies to the fake echem transition states</span>
<span class="sd">        &quot;&quot;&quot;</span>
	<span class="n">echem_TS_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">echem_transition_state_names</span>
        <span class="n">voltage</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">voltage</span>
        <span class="n">beta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span>
        <span class="n">thermo_dict</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">def</span> <span class="nf">get_E_to_G</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">E_to_G_dict</span><span class="p">):</span>
            <span class="n">E_to_G</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="k">for</span> <span class="n">ads</span> <span class="ow">in</span> <span class="n">state</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">ads</span> <span class="ow">in</span> <span class="n">E_to_G_dict</span><span class="p">:</span>
                    <span class="n">E_to_G</span> <span class="o">+=</span> <span class="n">E_to_G_dict</span><span class="p">[</span><span class="n">ads</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">E_to_G</span>

        <span class="k">for</span> <span class="n">echem_TS</span> <span class="ow">in</span> <span class="n">echem_TS_names</span><span class="p">:</span>
            <span class="n">preamble</span><span class="p">,</span> <span class="n">site</span> <span class="o">=</span> <span class="n">echem_TS</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;_&#39;</span><span class="p">)</span>
            <span class="n">echem</span><span class="p">,</span> <span class="n">rxn_index</span><span class="p">,</span> <span class="n">barrier</span> <span class="o">=</span> <span class="n">preamble</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;-&#39;</span><span class="p">)</span>
            <span class="n">rxn_index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">rxn_index</span><span class="p">)</span>
            <span class="n">rxn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">elementary_rxns</span><span class="p">[</span><span class="n">rxn_index</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">rxn_index</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rxn_options_dict</span><span class="p">[</span><span class="s">&#39;beta&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">beta</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rxn_options_dict</span><span class="p">[</span><span class="s">&#39;beta&#39;</span><span class="p">][</span><span class="n">rxn_index</span><span class="p">])</span>
            <span class="n">IS</span> <span class="o">=</span> <span class="n">rxn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">FS</span> <span class="o">=</span> <span class="n">rxn</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">E_IS</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_state_energy</span><span class="p">(</span><span class="n">IS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_electronic_energy_dict</span><span class="p">)</span>
            <span class="n">E_FS</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_state_energy</span><span class="p">(</span><span class="n">FS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_electronic_energy_dict</span><span class="p">)</span>
            <span class="n">G_IS</span> <span class="o">=</span> <span class="n">E_IS</span> <span class="o">+</span> <span class="n">get_E_to_G</span><span class="p">(</span><span class="n">IS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_correction_dict</span><span class="p">)</span>
            <span class="n">G_FS</span> <span class="o">=</span> <span class="n">E_FS</span> <span class="o">+</span> <span class="n">get_E_to_G</span><span class="p">(</span><span class="n">FS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_correction_dict</span><span class="p">)</span>
            <span class="n">dG</span> <span class="o">=</span> <span class="n">G_FS</span> <span class="o">-</span> <span class="n">G_IS</span>
            <span class="n">G_TS</span> <span class="o">=</span> <span class="n">G_FS</span> <span class="o">+</span> <span class="nb">float</span><span class="p">(</span><span class="n">barrier</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">beta</span><span class="p">)</span> <span class="o">*</span>  <span class="o">-</span><span class="n">dG</span>  <span class="c"># only tested for reductions</span>
            <span class="c"># make sure we&#39;re &quot;correcting&quot; the right value</span>
            <span class="k">assert</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_electronic_energy_dict</span><span class="p">[</span><span class="n">echem_TS</span><span class="p">])</span> <span class="o">==</span> <span class="mf">0.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_correction_dict</span><span class="p">[</span><span class="n">echem_TS</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>

            <span class="n">thermo_dict</span><span class="p">[</span><span class="n">echem_TS</span><span class="p">]</span> <span class="o">=</span> <span class="n">G_TS</span>
        <span class="k">return</span> <span class="n">thermo_dict</span>
</div>
<div class="viewcode-block" id="ThermoCorrections.get_rxn_index_from_TS"><a class="viewcode-back" href="../../../reference/catmap.thermodynamics.html#catmap.thermodynamics.enthalpy_entropy.ThermoCorrections.get_rxn_index_from_TS">[docs]</a>    <span class="k">def</span> <span class="nf">get_rxn_index_from_TS</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">TS</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">	Take in the name of a transition state and return the reaction index of</span>
<span class="sd">        the elementary rxn from which it belongs</span>
<span class="sd">        &quot;&quot;&quot;</span>
	<span class="k">for</span> <span class="n">rxn_index</span><span class="p">,</span> <span class="n">eq</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elementary_rxns</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">TS</span> <span class="ow">in</span> <span class="n">eq</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">rxn_index</span>
</div>
<div class="viewcode-block" id="ThermoCorrections.simple_electrochemical"><a class="viewcode-back" href="../../../reference/catmap.thermodynamics.html#catmap.thermodynamics.enthalpy_entropy.ThermoCorrections.simple_electrochemical">[docs]</a>    <span class="k">def</span> <span class="nf">simple_electrochemical</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Calculate electrochemical (potential) corrections to free energy. Transition state energies are corrected by a beta*voltage term.  </span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="n">thermo_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">gas_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">gas</span> <span class="k">for</span> <span class="n">gas</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_names</span> <span class="k">if</span> <span class="n">gas</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;pe&#39;</span><span class="p">,</span> <span class="s">&#39;ele&#39;</span><span class="p">]]</span>
        <span class="n">TS_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">TS</span> <span class="k">for</span> <span class="n">TS</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">transition_state_names</span> <span class="k">if</span>
            <span class="s">&#39;pe&#39;</span> <span class="ow">in</span> <span class="n">TS</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="s">&#39;ele&#39;</span> <span class="ow">in</span> <span class="n">TS</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="n">voltage</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">voltage</span>
        <span class="n">beta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span>

        <span class="c"># scale pe thermo correction by voltage (vs RHE)</span>
        <span class="k">for</span> <span class="n">gas</span> <span class="ow">in</span> <span class="n">gas_names</span><span class="p">:</span>
            <span class="n">thermo_dict</span><span class="p">[</span><span class="n">gas</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">voltage</span>

        <span class="c"># no hbond correction for simple_electrochemical</span>

        <span class="c"># correct TS energies with beta*voltage (and hbonding?)</span>
        <span class="k">for</span> <span class="n">TS</span> <span class="ow">in</span> <span class="n">TS_names</span><span class="p">:</span>
            <span class="n">rxn_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rxn_index_from_TS</span><span class="p">(</span><span class="n">TS</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">rxn_index</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rxn_options_dict</span><span class="p">[</span><span class="s">&#39;beta&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">beta</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rxn_options_dict</span><span class="p">[</span><span class="s">&#39;beta&#39;</span><span class="p">][</span><span class="n">rxn_index</span><span class="p">])</span>
            <span class="n">thermo_dict</span><span class="p">[</span><span class="n">TS</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">voltage</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">beta</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">thermo_dict</span>
</div>
<div class="viewcode-block" id="ThermoCorrections.hbond_electrochemical"><a class="viewcode-back" href="../../../reference/catmap.thermodynamics.html#catmap.thermodynamics.enthalpy_entropy.ThermoCorrections.hbond_electrochemical">[docs]</a>    <span class="k">def</span> <span class="nf">hbond_electrochemical</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Update simple_electrochemical with hbonding corrections as if they were on Pt(111)</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="n">thermo_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">simple_electrochemical</span><span class="p">()</span>
        <span class="n">TS_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">TS</span> <span class="k">for</span> <span class="n">TS</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">transition_state_names</span> <span class="k">if</span>
            <span class="s">&#39;pe&#39;</span> <span class="ow">in</span> <span class="n">TS</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="s">&#39;ele&#39;</span> <span class="ow">in</span> <span class="n">TS</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="n">hbond_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hbond_dict</span>
	<span class="k">for</span> <span class="n">ads</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">adsorbate_names</span><span class="p">)</span> <span class="o">+</span> <span class="n">TS_names</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ads</span> <span class="ow">in</span> <span class="n">hbond_dict</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">ads</span> <span class="ow">in</span> <span class="n">thermo_dict</span><span class="p">:</span>
                    <span class="n">thermo_dict</span><span class="p">[</span><span class="n">ads</span><span class="p">]</span> <span class="o">+=</span> <span class="n">hbond_dict</span><span class="p">[</span><span class="n">ads</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">thermo_dict</span><span class="p">[</span><span class="n">ads</span><span class="p">]</span> <span class="o">=</span> <span class="n">hbond_dict</span><span class="p">[</span><span class="n">ads</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">ads</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">hbond_dict</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">ads</span> <span class="ow">in</span> <span class="n">thermo_dict</span><span class="p">:</span>
                    <span class="n">thermo_dict</span><span class="p">[</span><span class="n">ads</span><span class="p">]</span> <span class="o">+=</span> <span class="n">hbond_dict</span><span class="p">[</span><span class="n">ads</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">thermo_dict</span><span class="p">[</span><span class="n">ads</span><span class="p">]</span> <span class="o">=</span> <span class="n">hbond_dict</span><span class="p">[</span><span class="n">ads</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>

        <span class="k">return</span> <span class="n">thermo_dict</span>
</div>
<div class="viewcode-block" id="ThermoCorrections.estimate_hbond_corr"><a class="viewcode-back" href="../../../reference/catmap.thermodynamics.html#catmap.thermodynamics.enthalpy_entropy.ThermoCorrections.estimate_hbond_corr">[docs]</a>    <span class="k">def</span> <span class="nf">estimate_hbond_corr</span><span class="p">(</span><span class="n">formula</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate hydrogen bonding corrections given a formula and estimations</span>
<span class="sd">        for various functional groups used in Peterson(2010) - valid mostly for Pt(111)</span>
<span class="sd">        This is a very simplistic function.  If you need more advanced descriptions of</span>
<span class="sd">        hydrogen bonding, consider setting your own hbond_dict.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">num_OH</span> <span class="o">=</span> <span class="n">formula</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s">&#39;OH&#39;</span><span class="p">)</span>
        <span class="n">num_O</span> <span class="o">=</span> <span class="n">get_composition</span><span class="p">(</span><span class="n">formula</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;_s&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s">&#39;O&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">num_ketone</span> <span class="o">=</span> <span class="n">num_O</span> <span class="o">-</span> <span class="n">num_OH</span>
        <span class="k">if</span> <span class="n">num_ketone</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&quot;(number of O) - (number of OH) is negative??&quot;</span>
            <span class="k">assert</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">formula</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&quot;OH_s&quot;</span><span class="p">,</span> <span class="s">&quot;OH&quot;</span><span class="p">]:</span>
            <span class="n">corr</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.50</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">corr</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.25</span> <span class="o">*</span> <span class="n">num_OH</span> <span class="o">+</span> <span class="o">-</span><span class="mf">0.10</span> <span class="o">*</span> <span class="n">num_ketone</span>
        <span class="k">print</span> <span class="s">&quot;estimated hbond correction for&quot;</span><span class="p">,</span> <span class="n">formula</span><span class="p">,</span> <span class="s">&quot;is&quot;</span><span class="p">,</span> <span class="n">corr</span>
        <span class="k">return</span> <span class="n">corr</span>
</div>
<div class="viewcode-block" id="ThermoCorrections.hbond_with_estimates_electrochemical"><a class="viewcode-back" href="../../../reference/catmap.thermodynamics.html#catmap.thermodynamics.enthalpy_entropy.ThermoCorrections.hbond_with_estimates_electrochemical">[docs]</a>    <span class="k">def</span> <span class="nf">hbond_with_estimates_electrochemical</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Add hbond corrections to transition states involving pe and ele (coupled proton-electron transfers and electron transfers)</span>
<span class="sd">	&quot;&quot;&quot;</span>
        <span class="n">thermo_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hbond_electrochemical</span><span class="p">()</span>
        <span class="n">TS_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">TS</span> <span class="k">for</span> <span class="n">TS</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">transition_state_names</span> <span class="k">if</span>
            <span class="s">&#39;pe&#39;</span> <span class="ow">in</span> <span class="n">TS</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="s">&#39;ele&#39;</span> <span class="ow">in</span> <span class="n">TS</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>

        <span class="k">for</span> <span class="n">ads</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">adsorbate_names</span><span class="p">)</span> <span class="o">+</span> <span class="n">TS_names</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ads</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">hbond_dict</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">ads</span> <span class="ow">in</span> <span class="n">thermo_dict</span><span class="p">:</span>
                    <span class="n">thermo_dict</span><span class="p">[</span><span class="n">ads</span><span class="p">]</span> <span class="o">+=</span> <span class="n">estimate_hbond_corr</span><span class="p">(</span><span class="n">ads</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">thermo_dict</span><span class="p">[</span><span class="n">ads</span><span class="p">]</span> <span class="o">=</span> <span class="n">estimate_hbond_corr</span><span class="p">(</span><span class="n">ads</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">thermo_dict</span>
</div>
<div class="viewcode-block" id="ThermoCorrections.boltzmann_coverages"><a class="viewcode-back" href="../../../reference/catmap.thermodynamics.html#catmap.thermodynamics.enthalpy_entropy.ThermoCorrections.boltzmann_coverages">[docs]</a>    <span class="k">def</span> <span class="nf">boltzmann_coverages</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">energy_dict</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	Return coverages based on Boltzmann distribution</span>
<span class="sd">	&quot;&quot;&quot;</span>
        <span class="c">#change the reference</span>
        <span class="n">reservoirs</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s">&#39;atomic_reservoir_dict&#39;</span><span class="p">,</span><span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">reservoirs</span><span class="p">:</span>
            <span class="n">comp_dict</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">sp</span> <span class="ow">in</span> <span class="n">energy_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">comp_dict</span><span class="p">[</span><span class="n">sp</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">species_definitions</span><span class="p">[</span><span class="n">sp</span><span class="p">][</span><span class="s">&#39;composition&#39;</span><span class="p">]</span>
            <span class="n">energy_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_formation_energies</span><span class="p">(</span>
                    <span class="n">energy_dict</span><span class="p">,</span><span class="n">reservoirs</span><span class="p">,</span><span class="n">comp_dict</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c">#calculate coverages</span>
        <span class="n">cvgs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">adsorbate_names</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">site</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">site_names</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">site</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">energy_dict</span><span class="p">:</span>
                <span class="n">energy_dict</span><span class="p">[</span><span class="n">site</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">relevant_ads</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">adsorbate_names</span> <span class="k">if</span> 
                    <span class="bp">self</span><span class="o">.</span><span class="n">species_definitions</span><span class="p">[</span><span class="n">a</span><span class="p">][</span><span class="s">&#39;site&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">site</span><span class="p">]</span>
            <span class="n">free_energies</span> <span class="o">=</span> <span class="p">[</span><span class="n">energy_dict</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">relevant_ads</span><span class="p">]</span><span class="o">+</span><span class="p">[</span><span class="n">energy_dict</span><span class="p">[</span><span class="n">site</span><span class="p">]]</span>
            <span class="n">boltz_sum</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">G</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_kB</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">temperature</span><span class="p">))</span> 
                <span class="k">for</span> <span class="n">G</span> <span class="ow">in</span> <span class="n">free_energies</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">ads</span> <span class="ow">in</span> <span class="n">relevant_ads</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">ads</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">adsorbate_names</span><span class="p">:</span>
                    <span class="n">i_overall</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">adsorbate_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ads</span><span class="p">)</span>
                    <span class="n">i_rel</span> <span class="o">=</span> <span class="n">relevant_ads</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ads</span><span class="p">)</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">species_definitions</span><span class="p">[</span><span class="n">site</span><span class="p">][</span><span class="s">&#39;type&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;gas&#39;</span><span class="p">]:</span>
                        <span class="n">cvgs</span><span class="p">[</span><span class="n">i_overall</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">free_energies</span><span class="p">[</span><span class="n">i_rel</span><span class="p">]</span><span class="o">/</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_kB</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">temperature</span><span class="p">))</span><span class="o">/</span><span class="n">boltz_sum</span>
        <span class="k">return</span> <span class="n">cvgs</span>
</div>
<div class="viewcode-block" id="ThermoCorrections.static_pressure"><a class="viewcode-back" href="../../../reference/catmap.thermodynamics.html#catmap.thermodynamics.enthalpy_entropy.ThermoCorrections.static_pressure">[docs]</a>    <span class="k">def</span> <span class="nf">static_pressure</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gas_pressures</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">species_definitions</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s">&#39;pressure&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_names</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="ThermoCorrections.concentration_pressure"><a class="viewcode-back" href="../../../reference/catmap.thermodynamics.html#catmap.thermodynamics.enthalpy_entropy.ThermoCorrections.concentration_pressure">[docs]</a>    <span class="k">def</span> <span class="nf">concentration_pressure</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="s">&#39;pressure&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">thermodynamic_variables</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">thermodynamic_variables</span> <span class="o">+=</span> <span class="p">[</span><span class="s">&#39;pressure&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_names</span><span class="p">:</span>
            <span class="k">if</span> <span class="s">&#39;concentration&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species_definitions</span><span class="p">[</span><span class="n">g</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s">&#39;Concentration not specified for &#39;</span><span class="o">+</span><span class="n">g</span><span class="o">+</span><span class="s">&#39;.&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gas_pressures</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">species_definitions</span><span class="p">[</span><span class="n">g</span><span class="p">][</span><span class="s">&#39;concentration&#39;</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">pressure</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_names</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="ThermoCorrections.approach_to_equilibrium_pressure"><a class="viewcode-back" href="../../../reference/catmap.thermodynamics.html#catmap.thermodynamics.enthalpy_entropy.ThermoCorrections.approach_to_equilibrium_pressure">[docs]</a>    <span class="k">def</span> <span class="nf">approach_to_equilibrium_pressure</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set product pressures based on approach to equilibrium. Requires the following attributes</span>
<span class="sd">        to be set:</span>
<span class="sd">        global_reactions - a list of global reactions in the same syntax as elementary expressions,</span>
<span class="sd">            with each one followed by its respective approach to equilibrium.</span>
<span class="sd">        pressure_mode - must be set to &#39;approach_to_equilibrium&#39;</span>
<span class="sd">        Note that this function is not well-tested and should be used with caution.</span>
<span class="sd">        &quot;&quot;&quot;</span>

           
        <span class="k">if</span> <span class="s">&#39;pressure&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">thermodynamic_variables</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">thermodynamic_variables</span> <span class="o">+=</span> <span class="p">[</span><span class="s">&#39;pressure&#39;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">pressure_mode</span> <span class="o">=</span> <span class="bp">None</span> <span class="c">#avoid recursion...</span>
        <span class="n">G_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaler</span><span class="o">.</span><span class="n">get_free_energies</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_descriptors</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pressure_mode</span> <span class="o">=</span> <span class="s">&#39;approach_to_equilibrium&#39;</span>

        <span class="k">def</span> <span class="nf">set_product_pressures</span><span class="p">(</span><span class="n">rxn</span><span class="p">,</span><span class="n">G_dict</span><span class="p">,</span><span class="n">gamma</span><span class="p">,</span><span class="n">gas_pressures</span><span class="p">,</span><span class="n">product_pressures</span><span class="o">=</span><span class="p">{}):</span>

            <span class="n">dG</span> <span class="o">=</span> <span class="n">mpf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_rxn_energy</span><span class="p">(</span><span class="n">rxn</span><span class="p">,</span><span class="n">G_dict</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">K_eq</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dG</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_kB</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">temperature</span><span class="p">))</span>
            <span class="n">K_eq</span> <span class="o">*=</span> <span class="n">mpf</span><span class="p">(</span><span class="n">gamma</span><span class="p">)</span>
            <span class="n">PK</span> <span class="o">=</span> <span class="n">K_eq</span>

            <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">gas_pressures</span><span class="p">:</span>
                <span class="n">n_g</span> <span class="o">=</span> <span class="n">mpf</span><span class="p">(</span><span class="n">rxn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">g</span><span class="p">))</span>
                <span class="n">p_g</span> <span class="o">=</span> <span class="n">mpf</span><span class="p">(</span><span class="n">gas_pressures</span><span class="p">[</span><span class="n">g</span><span class="p">])</span>
                <span class="n">PK</span> <span class="o">*=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">p_g</span><span class="p">,</span><span class="n">n_g</span><span class="p">)</span>

            <span class="c">#remove any products that have pressures specified</span>
            <span class="n">products</span> <span class="o">=</span> <span class="n">rxn</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">sp</span> <span class="ow">in</span> <span class="n">products</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">sp</span> <span class="ow">in</span> <span class="n">product_pressures</span><span class="p">:</span>
                    <span class="n">gas_pressures</span><span class="p">[</span><span class="n">sp</span><span class="p">]</span> <span class="o">=</span> <span class="n">product_pressures</span><span class="p">[</span><span class="n">sp</span><span class="p">]</span>
                    <span class="n">n_prod</span> <span class="o">=</span> <span class="n">products</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span>
                    <span class="n">PK</span> <span class="o">/=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">mpf</span><span class="p">(</span><span class="n">product_pressures</span><span class="p">[</span><span class="n">sp</span><span class="p">]),</span><span class="n">n_prod</span><span class="p">)</span>
                    <span class="n">products</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">products</span> <span class="k">if</span> <span class="n">p</span> <span class="o">!=</span> <span class="n">sp</span><span class="p">]</span>

            <span class="n">N_products</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">products</span><span class="p">)</span>
            <span class="n">P_i</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">PK</span><span class="p">,(</span><span class="n">mpf</span><span class="p">(</span><span class="mf">1.</span><span class="p">)</span><span class="o">/</span><span class="n">mpf</span><span class="p">(</span><span class="n">N_products</span><span class="p">)))</span>
            <span class="k">for</span> <span class="n">gi</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">products</span><span class="p">):</span>
                <span class="n">gas_pressures</span><span class="p">[</span><span class="n">gi</span><span class="p">]</span> <span class="o">+=</span> <span class="n">P_i</span>

        <span class="n">gas_pressures</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">global_rxns</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">gammas</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">reactants</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">products</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">gi</span><span class="p">,</span><span class="n">gamma_i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_reactions</span><span class="p">:</span>
            <span class="n">rxn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">expression_string_to_list</span><span class="p">(</span><span class="n">gi</span><span class="p">)</span>
            <span class="n">global_rxns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rxn</span><span class="p">)</span>
            <span class="n">reactants</span> <span class="o">+=</span> <span class="n">rxn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">products</span> <span class="o">+=</span> <span class="n">rxn</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">gammas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gamma_i</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">sp</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">reactants</span><span class="p">):</span>
            <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">species_definitions</span><span class="p">[</span><span class="n">sp</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;concentration&#39;</span><span class="p">,</span><span class="bp">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">c</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s">&#39;Concentrations must be specified for all reactants. No concentration &#39;</span>
                        <span class="s">&#39;was found for &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span><span class="o">+</span><span class="s">&#39;.&#39;</span><span class="p">)</span>
            <span class="n">gas_pressures</span><span class="p">[</span><span class="n">sp</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">pressure</span>

        <span class="n">product_pressures</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">sp</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">products</span><span class="p">):</span>
            <span class="n">gas_pressures</span><span class="p">[</span><span class="n">sp</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">species_definitions</span><span class="p">[</span><span class="n">sp</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;concentration&#39;</span><span class="p">,</span><span class="bp">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">c</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">product_pressures</span><span class="p">[</span><span class="n">sp</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">pressure</span>
                <span class="n">gas_pressures</span><span class="p">[</span><span class="n">sp</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">pressure</span>

        <span class="c">#Ensure that all gasses are either products or reactants</span>
        <span class="k">if</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">products</span><span class="p">))</span><span class="o">+</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">reactants</span><span class="p">)))</span> <span class="o">!=</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gas_names</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s">&#39;All gasses must appear as products or reactants in self.global_reactions.&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">gi</span><span class="p">,</span><span class="n">gamma_i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">global_rxns</span><span class="p">,</span><span class="n">gammas</span><span class="p">):</span>
            <span class="n">set_product_pressures</span><span class="p">(</span><span class="n">gi</span><span class="p">,</span><span class="n">G_dict</span><span class="p">,</span><span class="n">gamma_i</span><span class="p">,</span><span class="n">gas_pressures</span><span class="p">,</span><span class="n">product_pressures</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">gas_pressures</span> <span class="o">=</span> <span class="p">[</span><span class="n">gas_pressures</span><span class="p">[</span><span class="n">gi</span><span class="p">]</span> <span class="k">for</span> <span class="n">gi</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_names</span><span class="p">]</span> 
</div>
<div class="viewcode-block" id="ThermoCorrections.get_frequency_cutoff"><a class="viewcode-back" href="../../../reference/catmap.thermodynamics.html#catmap.thermodynamics.enthalpy_entropy.ThermoCorrections.get_frequency_cutoff">[docs]</a>    <span class="k">def</span> <span class="nf">get_frequency_cutoff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">kB_multiplier</span><span class="p">,</span><span class="n">temperature</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">kB</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_kB</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">temperature</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">T</span> <span class="o">=</span> <span class="n">temperature</span>

        <span class="k">def</span> <span class="nf">get_entropy</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span><span class="n">T</span><span class="p">):</span>
            <span class="n">nu_eV</span> <span class="o">=</span> <span class="n">nu</span><span class="o">*</span><span class="mf">1e-3</span> <span class="c">#input in meV</span>
            <span class="n">HT</span> <span class="o">=</span> <span class="n">HarmonicThermo</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">nu_eV</span><span class="p">)])</span>
            <span class="k">return</span> <span class="n">HT</span><span class="o">.</span><span class="n">get_entropy</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">T</span><span class="p">),</span><span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">target</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span><span class="n">kB_multiplier</span><span class="o">=</span><span class="n">kB_multiplier</span><span class="p">,</span><span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">):</span>
            <span class="n">nu</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mf">1e-8</span><span class="p">,</span><span class="n">nu</span><span class="p">)</span>
            <span class="n">SbykB</span> <span class="o">=</span> <span class="p">(</span><span class="n">get_entropy</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span><span class="n">T</span><span class="p">)</span><span class="o">/</span><span class="n">kB</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">kB_multiplier</span> <span class="o">-</span> <span class="n">SbykB</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>

        <span class="n">nu_cutoff</span> <span class="o">=</span> <span class="n">fmin_powell</span><span class="p">(</span><span class="n">target</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="n">disp</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">nu_cutoff</span>
</div>
<div class="viewcode-block" id="ThermoCorrections.summary_text"><a class="viewcode-back" href="../../../reference/catmap.thermodynamics.html#catmap.thermodynamics.enthalpy_entropy.ThermoCorrections.summary_text">[docs]</a>    <span class="k">def</span> <span class="nf">summary_text</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&#39;&#39;</span>

</div></div>
<div class="viewcode-block" id="fit_shomate"><a class="viewcode-back" href="../../../reference/catmap.thermodynamics.html#catmap.thermodynamics.enthalpy_entropy.fit_shomate">[docs]</a><span class="k">def</span> <span class="nf">fit_shomate</span><span class="p">(</span><span class="n">Ts</span><span class="p">,</span> <span class="n">Cps</span><span class="p">,</span> <span class="n">Hs</span><span class="p">,</span> <span class="n">Ss</span><span class="p">,</span> <span class="n">params0</span><span class="p">,</span><span class="n">plot_file</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">leastsq</span>
    <span class="k">def</span> <span class="nf">H</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">E</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">H_c</span><span class="p">):</span>
        <span class="n">H</span> <span class="o">=</span> <span class="n">A</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="p">(</span><span class="n">B</span><span class="o">/</span><span class="mf">2.0</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">C</span><span class="o">/</span><span class="mf">3.0</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="p">(</span><span class="n">D</span><span class="o">/</span><span class="mf">4.0</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">E</span><span class="o">/</span><span class="n">t</span> <span class="o">+</span> <span class="n">F</span> <span class="o">-</span> <span class="n">H_c</span> 
        <span class="c">#kJ/mol</span>
        <span class="k">return</span> <span class="n">H</span>
    <span class="k">def</span> <span class="nf">H_resid</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">H_act</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
        <span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">E</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">H_c</span> <span class="o">=</span> <span class="n">params</span>
        <span class="k">return</span> <span class="n">H_act</span> <span class="o">-</span> <span class="n">H</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">E</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">H_c</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">S</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">E</span><span class="p">,</span><span class="n">G</span><span class="p">):</span>
        <span class="n">S</span> <span class="o">=</span> <span class="n">A</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">B</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="p">(</span><span class="n">C</span><span class="o">/</span><span class="mf">2.0</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">D</span><span class="o">/</span><span class="mf">3.0</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="n">E</span><span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">G</span> 
        <span class="c">#J/mol*K</span>
        <span class="k">return</span> <span class="n">S</span>
    <span class="k">def</span> <span class="nf">S_resid</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">S_act</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
        <span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">E</span><span class="p">,</span><span class="n">G</span> <span class="o">=</span> <span class="n">params</span>
        <span class="k">return</span> <span class="n">S_act</span> <span class="o">-</span> <span class="n">S</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">E</span><span class="p">,</span><span class="n">G</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">Cp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">E</span><span class="p">):</span>
        <span class="n">Cp</span> <span class="o">=</span> <span class="n">A</span> <span class="o">+</span> <span class="n">B</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">C</span><span class="o">*</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">D</span><span class="o">*</span><span class="n">t</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span><span class="n">E</span><span class="o">/</span><span class="p">(</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Cp</span>

    <span class="k">def</span> <span class="nf">Cp_resid</span><span class="p">(</span><span class="n">params</span><span class="p">,</span><span class="n">Cp_act</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
        <span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">E</span> <span class="o">=</span> <span class="n">params</span>
        <span class="k">return</span> <span class="n">Cp_act</span> <span class="o">-</span> <span class="n">Cp</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">E</span><span class="p">)</span>

    <span class="n">A0</span><span class="p">,</span><span class="n">B0</span><span class="p">,</span><span class="n">C0</span><span class="p">,</span><span class="n">D0</span><span class="p">,</span><span class="n">E0</span><span class="p">,</span><span class="n">F0</span><span class="p">,</span><span class="n">G0</span><span class="p">,</span><span class="n">H0</span> <span class="o">=</span> <span class="n">params0</span>
    <span class="n">Cps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Cps</span><span class="p">)</span>
    <span class="n">Hs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Hs</span><span class="p">)</span>
    <span class="n">Ss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Ss</span><span class="p">)</span>
    <span class="n">ts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Ts</span><span class="p">)</span>
    <span class="n">ts</span> <span class="o">=</span> <span class="n">ts</span><span class="o">/</span><span class="mf">1000.0</span>

    <span class="p">[</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">E</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">H_c</span><span class="p">],</span><span class="n">flag</span> <span class="o">=</span> <span class="n">leastsq</span><span class="p">(</span>
            <span class="n">H_resid</span><span class="p">,[</span><span class="n">A0</span><span class="p">,</span><span class="n">B0</span><span class="p">,</span><span class="n">C0</span><span class="p">,</span><span class="n">D0</span><span class="p">,</span><span class="n">E0</span><span class="p">,</span><span class="n">F0</span><span class="p">,</span><span class="n">H0</span><span class="p">],</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">Hs</span><span class="p">,</span><span class="n">ts</span><span class="p">))</span>
    <span class="p">[</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">E</span><span class="p">,</span><span class="n">G</span><span class="p">],</span><span class="n">flag</span> <span class="o">=</span> <span class="n">leastsq</span><span class="p">(</span><span class="n">S_resid</span><span class="p">,[</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">E</span><span class="p">,</span><span class="n">G0</span><span class="p">],</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">Ss</span><span class="p">,</span><span class="n">ts</span><span class="p">))</span>


    <span class="k">if</span> <span class="n">plot_file</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">pylab</span> <span class="kn">as</span> <span class="nn">plt</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">131</span><span class="p">)</span>
        <span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">132</span><span class="p">)</span>
        <span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">133</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span><span class="n">H</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">E</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">H_c</span><span class="p">),</span><span class="s">&#39;-k&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span><span class="n">Hs</span><span class="p">,</span><span class="s">&#39;ok&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&#39;H&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span><span class="n">S</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">E</span><span class="p">,</span><span class="n">G</span><span class="p">),</span><span class="s">&#39;-r&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span><span class="n">Ss</span><span class="p">,</span><span class="s">&#39;or&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&#39;S&#39;</span><span class="p">)</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span><span class="n">Cp</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">E</span><span class="p">),</span><span class="s">&#39;-b&#39;</span><span class="p">)</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span><span class="n">Cps</span><span class="p">,</span><span class="s">&#39;ob&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&#39;Cps&#39;</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">plot_file</span><span class="p">)</span>


    <span class="k">return</span> <span class="p">[</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">E</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">G</span><span class="p">,</span><span class="n">H_c</span><span class="p">]</span>
</div>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">pylab</span> <span class="kn">as</span> <span class="nn">plt</span>

    <span class="k">def</span> <span class="nf">H2O_shomate</span><span class="p">(</span><span class="n">output_file</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">Ts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mf">298.15</span><span class="p">,</span><span class="mi">300</span><span class="p">,</span><span class="mi">400</span><span class="p">,</span><span class="mi">500</span><span class="p">,</span><span class="mi">600</span><span class="p">])</span>
        <span class="n">Cps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">33.299</span><span class="p">,</span><span class="mf">33.349</span><span class="p">,</span><span class="mf">33.59</span><span class="p">,</span><span class="mf">33.596</span><span class="p">,</span><span class="mf">34.262</span><span class="p">,</span><span class="mf">35.226</span><span class="p">,</span><span class="mf">36.325</span><span class="p">])</span>
        <span class="n">Hs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">6.615</span><span class="p">,</span><span class="o">-</span><span class="mf">3.282</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.062</span><span class="p">,</span><span class="mf">3.452</span><span class="p">,</span><span class="mf">6.925</span><span class="p">,</span><span class="mf">10.501</span><span class="p">])</span>
        <span class="n">Ss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">152.388</span><span class="p">,</span><span class="mf">175.485</span><span class="p">,</span><span class="mf">188.834</span><span class="p">,</span><span class="mf">189.042</span><span class="p">,</span><span class="mf">198.788</span><span class="p">,</span><span class="mf">206.534</span><span class="p">,</span><span class="mf">213.052</span><span class="p">])</span>
        <span class="n">params0</span> <span class="o">=</span> <span class="p">[</span><span class="mf">30.09200</span><span class="p">,</span><span class="mf">6.832514</span><span class="p">,</span><span class="mf">6.793435</span><span class="p">,</span>
                <span class="o">-</span><span class="mf">2.534480</span><span class="p">,</span><span class="mf">0.082139</span><span class="p">,</span><span class="o">-</span><span class="mf">250.8810</span><span class="p">,</span><span class="mf">223.3967</span><span class="p">,</span><span class="o">-</span><span class="mf">241.8264</span><span class="p">]</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">fit_shomate</span><span class="p">(</span><span class="n">Ts</span><span class="p">,</span><span class="n">Cps</span><span class="p">,</span><span class="n">Hs</span><span class="p">,</span><span class="n">Ss</span><span class="p">,</span><span class="n">params0</span><span class="p">,</span><span class="n">output_file</span><span class="p">)</span>
        <span class="n">params</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span> <span class="o">-=</span> <span class="n">params</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">params</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-=</span> <span class="n">params</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">params</span>

    <span class="k">def</span> <span class="nf">CH3OH_shomate</span><span class="p">(</span><span class="n">output_file</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Raw data from CRC handbook, 91st edition</span>
<span class="sd">        H is constrained to 0 since it can be lumped with F</span>
<span class="sd">	&quot;&quot;&quot;</span> 
	<span class="n">Ts</span> <span class="o">=</span>  <span class="p">[</span><span class="mf">298.15</span><span class="p">,</span> <span class="mf">300.0</span><span class="p">,</span> <span class="mf">400.0</span><span class="p">,</span> <span class="mf">500.0</span><span class="p">,</span> <span class="mf">600.0</span><span class="p">,</span> <span class="mf">700.0</span><span class="p">,</span> <span class="mf">800.0</span><span class="p">,</span> <span class="mf">900.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1100.0</span><span class="p">,</span> <span class="mf">1200.0</span><span class="p">,</span> <span class="mf">1300.0</span><span class="p">,</span> <span class="mf">1400.0</span><span class="p">,</span> <span class="mf">1500.0</span><span class="p">]</span>
        <span class="n">Ss</span> <span class="o">=</span>  <span class="p">[</span><span class="mf">239.865</span><span class="p">,</span> <span class="mf">240.139</span><span class="p">,</span> <span class="mf">253.845</span><span class="p">,</span> <span class="mf">266.257</span><span class="p">,</span> <span class="mf">277.835</span><span class="p">,</span> <span class="mf">288.719</span><span class="p">,</span> <span class="mf">298.987</span><span class="p">,</span> <span class="mf">308.696</span><span class="p">,</span> <span class="mf">317.896</span><span class="p">,</span> <span class="mf">326.629</span><span class="p">,</span> <span class="mf">334.93</span><span class="p">,</span> <span class="mf">342.833</span><span class="p">,</span> <span class="mf">350.367</span><span class="p">,</span> <span class="mf">357.558</span><span class="p">]</span>
        <span class="n">Cps</span> <span class="o">=</span>  <span class="p">[</span><span class="mf">44.101</span><span class="p">,</span> <span class="mf">44.219</span><span class="p">,</span> <span class="mf">51.713</span><span class="p">,</span> <span class="mf">59.8</span><span class="p">,</span> <span class="mf">67.294</span><span class="p">,</span> <span class="mf">73.958</span><span class="p">,</span> <span class="mf">79.838</span><span class="p">,</span> <span class="mf">85.025</span><span class="p">,</span> <span class="mf">89.597</span><span class="p">,</span> <span class="mf">93.624</span><span class="p">,</span> <span class="mf">97.165</span><span class="p">,</span> <span class="mf">100.277</span><span class="p">,</span> <span class="mf">103.014</span><span class="p">,</span> <span class="mf">105.422</span><span class="p">]</span>
        <span class="n">Hs</span> <span class="o">=</span>  <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.082</span><span class="p">,</span> <span class="mf">4.864</span><span class="p">,</span> <span class="mf">10.442</span><span class="p">,</span> <span class="mf">16.803</span><span class="p">,</span> <span class="mf">23.873</span><span class="p">,</span> <span class="mf">31.569</span><span class="p">,</span> <span class="mf">39.817</span><span class="p">,</span> <span class="mf">48.553</span><span class="p">,</span> <span class="mf">57.718</span><span class="p">,</span> <span class="mf">67.262</span><span class="p">,</span> <span class="mf">77.137</span><span class="p">,</span> <span class="mf">87.304</span><span class="p">,</span> <span class="mf">97.729</span><span class="p">]</span>
        <span class="n">params0</span> <span class="o">=</span> <span class="p">[</span><span class="mf">30.09200</span><span class="p">,</span><span class="mf">6.832514</span><span class="p">,</span><span class="mf">6.793435</span><span class="p">,</span>
                <span class="o">-</span><span class="mf">2.534480</span><span class="p">,</span><span class="mf">0.082139</span><span class="p">,</span><span class="o">-</span><span class="mf">250.8810</span><span class="p">,</span><span class="mf">223.3967</span><span class="p">,</span><span class="o">-</span><span class="mf">241.8264</span><span class="p">]</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">fit_shomate</span><span class="p">(</span><span class="n">Ts</span><span class="p">,</span><span class="n">Cps</span><span class="p">,</span><span class="n">Hs</span><span class="p">,</span><span class="n">Ss</span><span class="p">,</span><span class="n">params0</span><span class="p">,</span><span class="n">output_file</span><span class="p">)</span>
        <span class="n">params</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span> <span class="o">-=</span> <span class="n">params</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">params</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-=</span> <span class="n">params</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">params</span>

    <span class="k">def</span> <span class="nf">CH3CH2OH_shomate</span><span class="p">(</span><span class="n">output_file</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Raw data from CRC handbook, 91st edition</span>
<span class="sd">        H is constrained to 0 since it can be lumped with F</span>
<span class="sd">	&quot;&quot;&quot;</span>
        <span class="n">Ts</span> <span class="o">=</span>  <span class="p">[</span><span class="mf">298.15</span><span class="p">,</span> <span class="mf">300.0</span><span class="p">,</span> <span class="mf">400.0</span><span class="p">,</span> <span class="mf">500.0</span><span class="p">,</span> <span class="mf">600.0</span><span class="p">,</span> <span class="mf">700.0</span><span class="p">,</span> <span class="mf">800.0</span><span class="p">,</span> <span class="mf">900.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1100.0</span><span class="p">,</span> <span class="mf">1200.0</span><span class="p">]</span>
        <span class="n">Ss</span> <span class="o">=</span>  <span class="p">[</span><span class="mf">281.622</span><span class="p">,</span> <span class="mf">282.029</span><span class="p">,</span> <span class="mf">303.076</span><span class="p">,</span> <span class="mf">322.75</span><span class="p">,</span> <span class="mf">341.257</span><span class="p">,</span> <span class="mf">358.659</span><span class="p">,</span> <span class="mf">375.038</span><span class="p">,</span> <span class="mf">390.482</span><span class="p">,</span> <span class="mf">405.075</span><span class="p">,</span> <span class="mf">418.892</span><span class="p">,</span> <span class="mf">431.997</span><span class="p">]</span>
        <span class="n">Cps</span> <span class="o">=</span>  <span class="p">[</span><span class="mf">65.652</span><span class="p">,</span> <span class="mf">65.926</span><span class="p">,</span> <span class="mf">81.169</span><span class="p">,</span> <span class="mf">95.4</span><span class="p">,</span> <span class="mf">107.656</span><span class="p">,</span> <span class="mf">118.129</span><span class="p">,</span> <span class="mf">127.171</span><span class="p">,</span> <span class="mf">135.049</span><span class="p">,</span> <span class="mf">141.934</span><span class="p">,</span> <span class="mf">147.958</span><span class="p">,</span> <span class="mf">153.232</span><span class="p">]</span>
        <span class="n">Hs</span> <span class="o">=</span>  <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.122</span><span class="p">,</span> <span class="mf">7.474</span><span class="p">,</span> <span class="mf">16.318</span><span class="p">,</span> <span class="mf">26.487</span><span class="p">,</span> <span class="mf">37.79</span><span class="p">,</span> <span class="mf">50.065</span><span class="p">,</span> <span class="mf">63.185</span><span class="p">,</span> <span class="mf">77.042</span><span class="p">,</span> <span class="mf">91.543</span><span class="p">,</span> <span class="mf">106.609</span><span class="p">]</span>
        <span class="n">params0</span> <span class="o">=</span> <span class="p">[</span><span class="mf">30.09200</span><span class="p">,</span><span class="mf">6.832514</span><span class="p">,</span><span class="mf">6.793435</span><span class="p">,</span>
                <span class="o">-</span><span class="mf">2.534480</span><span class="p">,</span><span class="mf">0.082139</span><span class="p">,</span><span class="o">-</span><span class="mf">250.8810</span><span class="p">,</span><span class="mf">223.3967</span><span class="p">,</span><span class="o">-</span><span class="mf">241.8264</span><span class="p">]</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">fit_shomate</span><span class="p">(</span><span class="n">Ts</span><span class="p">,</span><span class="n">Cps</span><span class="p">,</span><span class="n">Hs</span><span class="p">,</span><span class="n">Ss</span><span class="p">,</span><span class="n">params0</span><span class="p">,</span><span class="n">output_file</span><span class="p">)</span>
        <span class="n">params</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span> <span class="o">-=</span> <span class="n">params</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">params</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-=</span> <span class="n">params</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">params</span>

    <span class="k">def</span> <span class="nf">CH3CHO_shomate</span><span class="p">(</span><span class="n">output_file</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Raw data from CRC handbook, 91st edition</span>
<span class="sd">        H is constrained to 0 since it can be lumped with F</span>
<span class="sd">	&quot;&quot;&quot;</span>
        <span class="n">Ts</span> <span class="o">=</span>  <span class="p">[</span><span class="mf">298.15</span><span class="p">,</span> <span class="mf">300.0</span><span class="p">,</span> <span class="mf">400.0</span><span class="p">,</span> <span class="mf">500.0</span><span class="p">,</span> <span class="mf">600.0</span><span class="p">,</span> <span class="mf">700.0</span><span class="p">,</span> <span class="mf">800.0</span><span class="p">,</span> <span class="mf">900.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1100.0</span><span class="p">,</span> <span class="mf">1200.0</span><span class="p">,</span> <span class="mf">1300.0</span><span class="p">,</span> <span class="mf">1400.0</span><span class="p">,</span> <span class="mf">1500.0</span><span class="p">]</span>
        <span class="n">Ss</span> <span class="o">=</span>  <span class="p">[</span><span class="mf">263.84</span><span class="p">,</span> <span class="mf">264.18</span><span class="p">,</span> <span class="mf">281.62</span><span class="p">,</span> <span class="mf">297.54</span><span class="p">,</span> <span class="mf">312.36</span><span class="p">,</span> <span class="mf">326.23</span><span class="p">,</span> <span class="mf">339.26</span><span class="p">,</span> <span class="mf">351.52</span><span class="p">,</span> <span class="mf">363.1</span><span class="p">,</span> <span class="mf">374.04</span><span class="p">,</span> <span class="mf">384.4</span><span class="p">,</span> <span class="mf">394.23</span><span class="p">,</span> <span class="mf">403.57</span><span class="p">,</span> <span class="mf">412.46</span><span class="p">]</span>
        <span class="n">Cps</span> <span class="o">=</span>  <span class="p">[</span><span class="mf">55.318</span><span class="p">,</span> <span class="mf">55.51</span><span class="p">,</span> <span class="mf">66.282</span><span class="p">,</span> <span class="mf">76.675</span><span class="p">,</span> <span class="mf">85.942</span><span class="p">,</span> <span class="mf">94.035</span><span class="p">,</span> <span class="mf">101.07</span><span class="p">,</span> <span class="mf">107.19</span><span class="p">,</span> <span class="mf">112.49</span><span class="p">,</span> <span class="mf">117.08</span><span class="p">,</span> <span class="mf">121.06</span><span class="p">,</span> <span class="mf">124.5</span><span class="p">,</span> <span class="mf">127.49</span><span class="p">,</span> <span class="mf">130.09</span><span class="p">]</span>
        <span class="n">Hs</span> <span class="o">=</span>  <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.103</span><span class="p">,</span> <span class="mf">6.189</span><span class="p">,</span> <span class="mf">13.345</span><span class="p">,</span> <span class="mf">21.486</span><span class="p">,</span> <span class="mf">30.494</span><span class="p">,</span> <span class="mf">40.258</span><span class="p">,</span> <span class="mf">50.698</span><span class="p">,</span> <span class="mf">61.669</span><span class="p">,</span> <span class="mf">73.153</span><span class="p">,</span> <span class="mf">85.065</span><span class="p">,</span> <span class="mf">97.344</span><span class="p">,</span> <span class="mf">109.954</span><span class="p">,</span> <span class="mf">122.834</span><span class="p">]</span>
        <span class="n">params0</span> <span class="o">=</span> <span class="p">[</span><span class="mf">30.09200</span><span class="p">,</span><span class="mf">6.832514</span><span class="p">,</span><span class="mf">6.793435</span><span class="p">,</span>
                <span class="o">-</span><span class="mf">2.534480</span><span class="p">,</span><span class="mf">0.082139</span><span class="p">,</span><span class="o">-</span><span class="mf">250.8810</span><span class="p">,</span><span class="mf">223.3967</span><span class="p">,</span><span class="o">-</span><span class="mf">241.8264</span><span class="p">]</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">fit_shomate</span><span class="p">(</span><span class="n">Ts</span><span class="p">,</span><span class="n">Cps</span><span class="p">,</span><span class="n">Hs</span><span class="p">,</span><span class="n">Ss</span><span class="p">,</span><span class="n">params0</span><span class="p">,</span><span class="n">output_file</span><span class="p">)</span>
        <span class="n">params</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span> <span class="o">-=</span> <span class="n">params</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">params</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-=</span> <span class="n">params</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">params</span>

    <span class="k">def</span> <span class="nf">ideal_shomate_comparison</span><span class="p">():</span> 

        <span class="sd">&quot;&quot;&quot; Compare ideal gas and shomate corrections</span>
<span class="sd">	&quot;&quot;&quot;</span>
        <span class="n">thermo</span> <span class="o">=</span> <span class="n">ThermoCorrections</span><span class="p">()</span>
<span class="c">#        thermo.gas_names = [g+&#39;_g&#39; for g in thermo.ideal_gas_params.keys()]</span>
        <span class="n">thermo</span><span class="o">.</span><span class="n">gas_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">g</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">thermo</span><span class="o">.</span><span class="n">ideal_gas_params</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
        <span class="n">thermo</span><span class="o">.</span><span class="n">gas_pressures</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">thermo</span><span class="o">.</span><span class="n">gas_names</span><span class="p">)</span>
        <span class="n">T_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
        <span class="n">err_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="n">thermo</span><span class="o">.</span><span class="n">gas_names</span>
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">:</span>
            <span class="n">err_dict</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">T</span> <span class="ow">in</span> <span class="n">T_range</span><span class="p">:</span>
            <span class="n">thermo</span><span class="o">.</span><span class="n">temperature</span> <span class="o">=</span> <span class="n">T</span>
            <span class="n">ideal_dict</span> <span class="o">=</span> <span class="n">thermo</span><span class="o">.</span><span class="n">ideal_gas</span><span class="p">()</span>
            <span class="n">shomate_dict</span> <span class="o">=</span> <span class="n">thermo</span><span class="o">.</span><span class="n">shomate_gas</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">thermo</span><span class="o">.</span><span class="n">gas_names</span><span class="p">:</span>
                <span class="n">err</span> <span class="o">=</span> <span class="n">ideal_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">-</span> <span class="n">shomate_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                <span class="n">err_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">T_range</span><span class="p">,</span><span class="n">err_dict</span><span class="p">[</span><span class="n">label</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;shomate_ideal_comparison.pdf&#39;</span><span class="p">)</span>

    <span class="k">print</span> <span class="s">&#39;methanol&#39;</span><span class="p">,</span><span class="n">CH3OH_shomate</span><span class="p">(</span><span class="s">&#39;methanol_shomate.pdf&#39;</span><span class="p">)</span>
    <span class="k">print</span> <span class="s">&#39;ethanol&#39;</span><span class="p">,</span><span class="n">CH3CH2OH_shomate</span><span class="p">(</span><span class="s">&#39;ethanol_shomate.pdf&#39;</span><span class="p">)</span>
    <span class="k">print</span> <span class="s">&#39;acetaldehyde&#39;</span><span class="p">,</span><span class="n">CH3CHO_shomate</span><span class="p">(</span><span class="s">&#39;acetaldehyde_shomate.pdf&#39;</span><span class="p">)</span>

    <span class="n">ideal_shomate_comparison</span><span class="p">()</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">CatMAP 0.2.79 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &raquo;</li>
          <li class="nav-item nav-item-2"><a href="../../catmap.html" >catmap</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2014, Andrew J. Medford.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>